> 希望这份整理能帮到你😊

# 简介

## 内容包括：

- 知识点

- PS                                                                          

## 内容修改：

源文件位置：https://github.com/jac0b-max/notes.git

可以下载markdown格式的源文件到本地，对内容进行修改。

## 邀您共创：

欢迎您加入共创笔记项目。

# Chapter1: Finding extrema of functions(求函数极值)

### 定理1：

如果 $f: I \to \mathbb{R}$ 在 $I$ 内的每一点上都是可微的，则：

如果 $f ' (x)>0$ 对 $I$ 中的所有 $x$ 都成立，则 $f$ 在 $I$ 上递增。

如果 $f ' (x)>0$ 对 $I$ 中的所有 $x$ 都成立，则 $f$ 在 $I$ 上递减。

### 定义1：

对于某个（足够小的）开区间 $c$ 内的所有 $x$ 值：

当 $f (c)≤f (x)$ 时，函数 $f$ 在 $x = c$ 处具有相对极小值或局部极小值；（relative or local minimum）

当 $f (c)≥f (x)$ 时，函数 $f$ 在 $x = c$ 处具有相对极小值或局部极小值。（relative or local maximum）

对于 $f$ 的定义域内的所有 $x$：

如果点 $x = c$ 满足 $f (c)≤f (x)$ ，则称 $c$ 为绝对最小值；（absolute minimum）

如果点 $x = c$ 满足 $f (c)≥f (x)$ ，则称 $c$ 为绝对最大值。（absolute maximum）

如果 $c$ 不是 $f$ 的定义域的端点，并且当 $x$ 从左到右经过 $c$ 时，f' 由负变为正，那么 $c$ 是 $f$ 的一个局部最小值。

如果 $c$ 不是 $f$ 的定义域的端点，并且当 $x$ 从左到右经过 $c$ 时，f' 由正变为负，那么 $c$ 是 $f$ 的一个局部最大值。

注意：$f ' (c) = 0$并不意味着 $f$ 在 $c$ 处有局部最大值或最小值, 比如 $y = x^3 at x = 0$.

### 定义2：

设 $f∶(a,b)→R$ 为可微函数。如果 $f ' (c) = 0$，则点 $c$ 称为 $f$ 的临界点。

### 定理2：

设 $f∶(a,b)→R$ 为二次可微函数，且 $c∈(a,b) $为f的临界点（即 $f ' (c) = 0$ ）。

(i)   若 $f''(c) >0$，则 $f$ 在 $c$ 处有局部极小值。

(ii)  若 $f''(c) < 0$，则 $f$ 在 $c$ 处有局部极大值。

(iii) 若 $f''(c) = 0$，且$f''$经过$c$时改变符号，则$c$是$f$的拐点。

### 定义3：

我们说可微函数 $y = f (x)$ 的图形

在$f ' (x)$减小的区间上向下凸 (concave downward)

在$f ' (x)$增大的区间内向上凹 (concave upward)

### 定理3:

$y = f(x)$的图形

在$f ''(x) < 0$的任何区间上向下凸，(concave downward)

在$f ''(x) >0$的任何区间上向上凹。(concave upward)

### 定义4：

曲线上凹凸变化的点称为拐点。a point of inflection (inflexion).

因此：二次可微曲线上的拐点是$f ' ' (x)$在一边为正而在另一边为负的点。

在拐点处，$f ''(x) = 0$.。然而，$f ' ' (x)$在非拐点处也可以为零。



几何解释：

$f$ 在 $c$ 点的一阶导数表示 $f$ 在 $c$ 点所表示的曲线的切线斜率。

$f$ 在点 $c$ 处的二阶导数表示与 $f$ 在点 $c$ 处所表示的曲线相切的抛物线的第一个系数。

泰勒展开式： $f (x) = c +f '(c)(x −c)+ \dfrac{f''(c)}{2} (x−c)^2+⋅⋅⋅+ \dfrac{f^n(c)} {n!} (x−c)n+...$

### 定义5：

$Aij$ : $A$ 的子矩阵(submatrix): 删除 $A$ 的第 $i$ 行和第$j$ 列得到的 $(m−1)×(n−1)$矩阵。

### 定义6：

设$A = [aij]$是一个n阶的方阵

If n = 1, then $detA = a_{11}$,

If n = 2, then $detA = a_{11}a_{22} −a_{12}a_{21}$

If n > 2, then $detA = (−1)^{1+k} a_{1k} detA_{11}. ∑ k=1 (a11 detA11 −a12detA12 +⋯+(−1)1+na1n detA1n)$

### 定义7：

i,j 余子式 (i,j-minor)：$detA_{ij}$

i,j 伴随式或代数余子式 (i,j-cofactor): $(-1)^{i+j}detA_{ij}$

### 定理4：

沿第i行的余子式展开求矩阵行列式：

$detA =(−1)^{i+1}a_{i1} detA_{i1} +(−1)^{i+2}a_{i2} detA_{i2} +⋯+(−1)^{i+n} a_{in} detA_{in}=∑_{k=1}^n (−1)^{i+k} a_{ik} detA_{ik}$

### 定理5：

沿第j列的余子式展开求矩阵行列式：

$detA =(−1)^{1+j}a_{1j} detA_{1j} +(−1)^{2+j}a_{2j} detA_{2j} +⋯+(−1)^{n+j} a_{nj} detA_{nj}=∑_{k=1}^n (−1)^{k+j} a_{kj} detA_{kj}$

### 梯度：

 $∇f =(\dfrac{∂f}{∂x},\dfrac{∂f}{∂y},\dfrac{∂f}{∂z})$

临界点： $∇f =(\dfrac{∂f}{∂x},\dfrac{∂f}{∂y},\dfrac{∂f}{∂z})=\bold0$

临界点可能是：局部最大值，局部最小值，或鞍点（一个不是局部最大值或局部最小值的临界点）

海森矩阵$A = \begin{pmatrix} f_{11} & f_{12}&f_{13}&...&f_{1n} \\ f_{21} & f_{22} & f_{23}& ...& f_{2n}\\\vdots&\vdots&\vdots&\vdots&\vdots\\ f_{n1} & f_{n2} & f_{n3}& ...& f_{nn}\end{pmatrix} $

第一子矩阵$H_1(\mathbf{x}) = \begin{pmatrix} f_{11}\end{pmatrix} $

第二子矩阵$H_2(\mathbf{x})= \begin{pmatrix} f_{11} & f_{12}\\ f_{21} & f_{22} \end{pmatrix} $

 主子式 (Principal minors): $∆_k(x)=det(H_k(\mathbf{x}))$



### 定理（二阶偏导数检验)：

设 $P$ 为二次可微函数$f∶\mathbb{R}^n→R$的一个临界点。

如果$(−1)^k∆k(P) > 0$对于所有$k = 1,…,n$ 成立，则 $P$ 处是局部最大值。

如果$∆k(P) > 0$对于所有$k = 1,…,n$ 成立，则 $P$ 处是局部最小值。

如果 $∆n(P) = det(H(P)) \neq 0$,则 $P$ 处是鞍点。

如果 $∆n(P) = det(H(P)) = 0$ ，则无法判定该临界点的类别





# Chapter2: Linear Programming: the graphical method（线性规划：图解法）

我们可以在 $R^n$ 中用以下形式表示一般的线性不等式： 
$$
\mathbf{v}\cdot\mathbf{x}≤\mathbf{c}
$$
其中 $\mathbf{v} = (v_1,...,v_n)$ 和  $\mathbf{x}=(x_1,...x_n)$ 是$ Rn $中的向量，并且这是向量$\mathbf{v}$ 和 $\mathbf{x}$ 的通常“内积”。 如果 $< $ 成立，那么这个不等式在 x 处称为松弛slack。 如果 = 成立，则称在 x 处绑定binding。 如果在 x 处不成立（即如果 > 成立），则称其在 x 处不满足unsatisfied

用向量符号表示，最大化问题在于求出

受……的约束，；以……为条件

$\mathbf{v}\cdot\mathbf{x}≤\mathbf{c}$ 且 $\mathbf{x}≥\mathbf{0}$

满足所有约束条件的变量集合：${x∈R^n|\mathbf{v}\cdot\mathbf{x}≤\mathbf{c} , \mathbf{x}≥\mathbf{0}}$

称为可行集。 请注意，在某些情况下可行解集可能是空的。 为了解决这个最大化问题，我们将考虑 

（1）图形法，以及 （2）单纯形法。

对于图形法而言，重要的是我们能够直观地看到可行解集。 对于 n = 2，我们可以这样做。 尽管有可能，但对于 n = 3 的情况，可行解集就没那么容易了…… 对于 n ≥4 来说，这几乎变得不可能

求解线性规划问题的图解法步骤:

1. 画出可行域

2. 将目标函数表示为直线，并通过平移寻找最优解

3. 目标函数与可行域的交点即为最优解，计算该点的坐标和对应的目标函数值。

一个线性规划问题可能不会给出最大值或最小值。这可能有两个原 因： 1. 可行解集为空； 2.可行域是无界的。

如果线性规划问题的可行域非空且有界，那么目标函数存在最大 值和最小值。

# Chapter 3: Lagrange Multipliers（拉格朗日乘数法）



# Chapter4:  The Simplex Method（单形法）

### 单形法的要求：

1. 约束的右边是非负的

2. 所有约束条件必须是等式

3. 所有变量被限制为非负值。

对于LP问题，满足这些要求的约束集是标准形式的约束集。

 

### 如何将约束集转化为标准形式：

1. 如果约束的右边是负的，则将等式两边乘以 -1
2. 对于 $≤$ 的式子：我们在约束的左侧添加一个松弛变量s，将其转化为等式。
3. 对于 $≥$ 的式子：我们从约束的左侧减去一个剩余变量e，同时，添加一个人工变量a。
4. 对于 $=$ 的式子：我们在约束的左侧添加一个人工变量a
5. 松弛、剩余和人工变量都为为非负变量。



### 求矩阵的逆：

第一步：写出增广矩阵$ (A ∣ I)$. $I$ 是单位矩阵

第二步：对整个增广矩阵进行行运算，将A变换成单位矩阵。 $(I ∣ A^{−1})$

这种方法被称为高斯消元法。行运算只有三种:

1. 交换两行。 

2. 将某一行的每个元素乘以一个非零常数。 

3. 用另一行的倍数相加或相减来替换一行

 

### 单纯形法:

一种寻找极值点的方法是检查每个顶点，计算其值并检查可行 性。 单纯形法是一种更有效的解决方法：我们从一个可行顶点开始，沿着 可行顶点前进，直到找到极值点为止。 基本的工具是高斯消元法，就像求矩阵的逆矩阵时所用的过程 一样

 

#### 实例：

有以下约束

$$
\left\{
\begin{array}{l}
2x+y≤6 \\
x+2y≤8 \\
x,y≥0\\
\end{array}
\right.
$$


求
$$
max :{3x+2y}
$$
第一步：将约束条件化为标准形式，引入两个松弛变量 s1 和 s2，
$$
\left\{
\begin{array}{l}
2x+y+s_1=6 \\
x+2y+s_2=8\\
x,y,s_1,s_2≥0\\
\end{array}
\right.
$$
目标：
$$
max: z=3x+2y
$$
第二步：目标函数和约束条件被组合起来形成一个方程组：
$$
\left\{
\begin{array}{l}
z-3x-2y=0 \\
2x+y+s_1=6\\
x+2y+s_2=8\\
\end{array}
\right.
$$


第三步：以表格形式（表）来呈现。

请注意，每行对应一个方程，表中包含方程中每个变量的系数。

ci 列包含方程的右侧常数。

| $z$  | $x$  | $y$  | $s_1$ | $s_2$ | $c_i$ | Row number |
| :--: | :--: | :--: | :---: | :---: | :---: | :--------: |
|  1   |  -3  |  -2  |   0   |   0   |   0   |   $R_0$    |
|  0   |  2   |  1   |   1   |   0   |   6   |   $R_1$    |
|  0   |  1   |  2   |   0   |   1   |   8   |   $R_2$    |



我们的起点是通过令 $x$ 和 $y$ 等于 0 而得到的。在我们的问题中，初 始解为 $s_1$ = 6，$s_2$ = 8 且 $z$ = 0。

这个解决方案是可行的，因为我们确保了 $c_i$ 列中的所有条目均为非 负数。

然而，这个解并非最优解：我们可以将 $y$（或 $x$）的值稍微增大一 点，仍能得到一个可行解，并且 $z$ 的值会更高。

 

规则（1）： 

如果任何系数为负，那么通过增加相应变量的值就能找到一个更优的 解。 如果 R0 行中的所有系数均为 ≥0，则已找到最优解。

本案中，最大解尚未找到！

为了使 z 值得到最大程度的改善，我们将选择在第（0）行中系数最负的列。

 

规则（2）： 

关键列是函数 R0 行中系数最小的那一列。 

在我们的示例中，这就是对应于 x 变量的那一列。 

如果将关键列中的系数称为 aij（i = 1,...,m），那么我们选取满足 aij > 0 且 ci / aij 最 小的行 i 。对于关键列 j，我们确定与之相关的行 i 。

Min_i\dfrac{c_i}{a_ij} where a_ij>0

本案中，关键行是：行 R1。

 

我们现在对表格进行行运算，将根据规则（3）找到的行中的系数化 为 1，并将关键列中的其他所有系数化为 0 。 我们按以下正确的顺序依次进行一项操作，具体为：
$$
R_1→\dfrac{1}{2}R_1\\
R_0=R_0- 3R_1 \\
R_2→R_2- R_1
$$


| $z$  | $x$  | $y$            | $s_1$ | $s_2$ | $c_i$ | Row number |
| :--: | :--: | :------------: | :---: | :---: | :---: | :--------: |
| 1    | 0    | $-\dfrac{1}{2}$           | $-\dfrac{3}{2}$ | 0     | 9    | $R_0$      |
| 0    | 1    | $\dfrac{1}{2}$           | $\dfrac{1}{2}$ | 0     | 3    | $R_1$      |
| 0    | 0    | $\dfrac{3}{2}$ | $-\dfrac{1}{2}$ | 9    | 5    | $R_2$      |



该解仍非最优（行（0）中 y 变量的系数为 负，关键列对应于 y，规则（3）中的行是行（2）。

 

在这个新的布局中，我们重复规则（1）至（3）。

根据规则（1）可知，由 于行（0）中的所有系数均≥0，所以此解为最优解



| $z$  | $x$  | $y$  |      $s_1$      |      $s_2$      |      $c_i$      | Row number |
| :--: | :--: | :--: | :-------------: | :-------------: | :-------------: | :--------: |
|  1   |  0   |  0   | $\dfrac{4}{3}$  | $\dfrac{1}{3}$  | $\dfrac{32}{3}$ |   $R_0$    |
|  0   |  1   |  0   | $\dfrac{2}{3}$  | $-\dfrac{1}{3}$ | $\dfrac{4}{3}$  |   $R_1$    |
|  0   |  0   |  1   | $-\dfrac{1}{3}$ | $\dfrac{2}{3}$  | $\dfrac{10}{3}$ |   $R_2$    |

一旦我们找到了对应最优解的最终表，就可以按如下方式读出 该解： 1 . 将行 R0 中所有系数不为零的变量都设为 0； 2其他变量的相应值可以从其他行中读出。 在我们的最后一个例子中，这得出 x1 = 4/3，x2 = 10/3，s1 = 0，s2 = 0。 MA

 

关键：利用初等行变换将矩阵中的第 j 列的第 i 行元素化为 1，其余元素化为 0 。

 

观察结果：

第 R0 行 ci 列中的值是我们要最大化的函数的“当前值”； 

随着每个新表格的出现，这个数字应当增加（或保持不变）； 

在每个表中，ci 列中的所有其他项都应是非负的； 

如果出现负数，那我们就出错了。

 

请注意！这里所说的“其他”指的是 ci 列中除 R0 行之外的所有值。 行 R0 中的常数有可能为负。

 

具有混合约束条件的最大化问题：

如果遇到具有混合约束条件的最大化问题，单纯形法本身并不会改变。 

在开始通常的单纯形算法之前，我们只需对几个地方稍作改动。 

回想一下，在将约束条件转换为标准形式时，

对于每一个 “≥”约束条件，在其左侧减去一个剩余变量并加上一个人工变量。

对于每个“=”约束条件，在其左侧添加一个人工变量。 

对于每个这样的补充变量，都会在单纯形表中增加一列。

 

变换目标函数：

与仅有“≤“约束的情况相比，主要的区别在于，如果存在剩余变量和人工变量，我们必须修改目标函数：必须在目标函数中为它们分配适当的系数。

对于剩余变量，我们将其系数设为 0（就像松弛变量那样）。 

人工变量被赋予一个很大的负系数 -M，其中 M 被假定为比任何其他系数都大得多。 

这种选择使得人工变量变得非常非常“不具吸引力”。 这种方法让它们变得非常小……让它们消失！

 

混合约束条件下最优化问题概述 如果我们遇到一个具有混合约束条件的最大化问题，我们就必须 通过引入松弛变量、剩余变量和人工变量，将约束条件化 为标准形式； 在目标函数中，给所有人工变量分配一个很大的负 系数 -M； 建立初始表； 通过行运算将人工变量所在行 R0 的系数变为零； 经过此过程，人工变量和松弛变量的系数应为零； 剩余变量的系数可以是非零的； 像之前那样用单纯形法求解。

实例：行运算有三种：

两行互换位置

将一行中的每个元素乘以一个非零常数。

通过对某一行加上或减去另一行的倍数来替换该行。



#### 例子：



### 没有可行解与约束无边界的情况：

我们解决了一个LP问题，并且其中一个人工变量具有非零值，那么我们就会遇到没有可行解的情况。

如果关键列中的所有系数都是0或负数，存在LP问题的无界解。



# Chapter 5：线性规划中的对偶理论

## 对偶问题

对于每一个线性规划问题，我们都可以关联一个所谓的对偶问题，它同样是一个线性规划问题。 对偶问题可以根据原问题中的信息来构建。 我们可以从原问题的最终表中得到对偶问题的解。 这意味着，要解决对偶问题，我们既可以直接求解，也可以先求 解原问题。 有时一个选择比另一个更容易。 

尽管对偶理论可以一般性地描述（即所有类型的线性规划问题都存在对偶问题），但我们将仅考虑具有 ≤ 约束的最大化问 题。

## 对偶问题的构建

考虑一个仅含 ≤ 约束的最大化问题，

那么，对偶问题是一个仅含“≥”约束条件的最小化问题； 

对于原问题中的每个变量，我们在对偶问题中都会得到一个约束条件

对于原问题中的每一个约束条件，在对偶问题中都会得到一个变量 

原问题中目标函数的系数，在对偶问题中是约束条件的右端常数 

原问题中约束条件右侧的常数，在对偶问题中是目标函数的系数

原问题中约束条件里的变量系数，在对偶问题的约束条件中仍是变量系数。不过，行变成了列，列变成了行。

如果问题是在以下约束条件下最大化 $z = b_1x_1 + b_2x_2 + \ldots + b_nx_n $：

$$
\begin{align*}
a_{11}x_1 + a_{12}x_2 + \ldots + a_{1n}x_n & \leq c_1, \\
a_{21}x_1 + a_{22}x_2 + \ldots + a_{2n}x_n & \leq c_2, \\
& \vdots \\
a_{m1}x_1 + a_{m2}x_2 + \ldots + a_{mn}x_n & \leq c_m,
\end{align*}
$$

其中 $ x_1, x_2, \ldots, x_n \geq 0 $。

那么对侧问题就是求最小化：$z = c_1y_1 + c_2y_2 + \ldots + c_ny_n $

$$
\begin{align*}
a_{11}y_1 + a_{21}y_2 + \ldots + a_{m1}y_m & \geq b_1, \\
a_{12}y_1 + a_{22}y_2 + \ldots + a_{m2}y_m & \geq b_2, \\
& \vdots \\
a_{1n}y_1 + a_{2n}y_2 + \ldots + a_{mn}y_m & \geq b_n,
\end{align*}
$$

其中：

$$
y_1, y_2, \ldots, y_m \geq 0.
$$

对偶问题的解 

如果我们解决了原问题，就可以从最终的表格中读出对偶问题的解：

 对偶问题中目标函数的最小值与原问题中目标函数的最大值相同； 

在对偶问题中，使该最小值得以实现的 y_1, y_2, ... ,y_m 的值，就是原始问题中行 R_0 中对应于松弛变量的系数：即 y_i 的值就是 s_i 的系数。

# Chapter 6：

## 目前已学

- 无约束条件下二次函数的优化（例如 $ \mathbf{x} $ 的一阶、二阶导数进行一阶（偏）数值极值、端点的研究等）。

- 利用拉格朗日乘数法对具有等式约束条件的函数进行优化。

- 线性规划是用于在线性不等式约束条件下优化线性函 数的方法。

- 在非线性规划中，我们将考虑以下问题：在满足约束条件情况下，最大化函数 $ f(x_1, x_2, \ldots, x_n) $：

$$
g_1(x_1, x_2, \ldots, x_n) \leq c_1
$$

$$
g_2(x_1, x_2, \ldots, x_n) \leq c_2
$$

$$
\vdots
$$

$$
g_m(x_1, x_2, \ldots, x_n) \leq c_m
$$

满足所需约束条件的向量为 $ \mathbf{x} = (x_1, x_2, \ldots, x_n) $ 被称作约束集，或可行集。



## 一个简单的例子：2个变量，1个约束条件

考虑非线性规划问题：求 $\max f(x, y) $ 使得 $ g(x, y) \leq c $ 成立。

我们将必须考虑两种情况：

**情况 1（内部）：**

在 $ g(x, y)<c $ 的约束条件下求 $ \max f(x, y) $。

对于情况 1，我们必须考虑可行集内部的临界点。因此，我们要求解：

$$
\nabla f(x, y) = (0,0) \quad \text{and} \quad g(x,y)<c
$$

**情况 2（边界情况）：**

在 $ g(x, y) = c $ 的约束条件下求 $ \max f(x, y) $。

对于情况 2，我们需要讨论可行集边界上的情况。因此，我们使用拉格朗日乘数：

$$
\nabla f(x, y) = \lambda \nabla g(x, y) \quad \text{and} \quad g(x,y)=c
$$


如果我们找出所有满足上述两种情况之一的 $(x,y)$ ，那么我们就得到了该问题所有可能的解。 

我们得到的这些点可能是局部极小值或极大值点，也可能是某种鞍点。 

## 极值定理 

定理 1： 如果函数 $f$ 在 $\mathbb{R^n}$ 中的闭合且有界的集合 $S$ 上连续，那么 $f$ 在 $S$ 上有最大值和最小值。  

(1)我们将要讨论的函数总是连续的； 

(2)对于我们的非线性规划问题，由于 $ g_i$ 是连续的，可行域自然就是闭合的集合； 

(3)唯一不是自动满足的条件是可行集的有界性。这是我们需要检查的内容。在我们遇到的大多数例子中，它确实是有界的。 

如果这三个条件都满足，那么该定理就保证了函数存在最大值和最小值。 由于最大值和最小值只能出现在最优解的候选点之一，所以我们只需查看函数在这些点的值，就能选出正确的那个。



定义 1：

 我们称以 $ c $ 为中心，半径为 $ r $ 的 $ n $ 维开球为以下集合： 
$$
B(c, r) := \{ x \in \mathbb{R}^n \ | \ |x - c| < r \}
$$
定义 2： 

集合 $ D \subseteq \mathbb{R}^n $ 被称为： 

- 开集，若对其所有点 $ x \in D $，存在一个开球 $ B(c, r) $ 使得 $ x \in B(c, r) \subseteq D $。 
- 闭集，若 $ D = \mathbb{R}^n \setminus D$是开集。

## Proposition 1:
如果 $ g: \mathbb{R}^n \to \mathbb{R} $ 是一个连续方程, 那么封闭集的原像(preimage) 是封闭集，开集的原像是开集。



## Kuhn-Tucker Theory (多个变量，多个约束) 

对于求解一般形式的非线性规划问题：

约束为：
$$
g_1(x_1, \ldots, x_n) < c_1 \\
g_2(x_1, \ldots, x_n) < c_2,  \\
\vdots \\
g_m(x_1, \ldots, x_n) < c_m,
$$
最大化: $ f(x_1, \ldots, x_n) $  

步骤是：

1. 考虑   $ \nabla f(x) = \sum_{i=1}^{m} \lambda_i \nabla g_i(x)$
2. 引入：$ \lambda_i = 0$  if $ g_i(x) < c_i $
3.  约束需满足 $ g_i(x) \leq c_i \quad \text{for} \quad  i = 1, \ldots, m $.



按照上述步骤列出方程组，找出所有可能的点，然后判断最值点。 

如果约束条件是一个等式，我们称之为“有效约束”active。

若为不等 式，则称其为“无效约束”inactive。 

上述步骤的第二部分告诉我们：如果约束条件 $g_i(x)$ 不起作用，我 们必须引入额外条件 $\lambda_i = 0$ 。 

如果我们想用这个方案解决这个问题，就必须考虑所有不同的选项：每个约束条件都可能是有效的，也可能是无效的。



# Chapter 7：凸函数的优化 Optimization of Convex Functions

## 已经解决的问题：

1. 无约束条件下一元或多元函数的优化：一阶条件 ∇f(x) = 0，用海森矩阵进行二阶（偏）导数检验，端点的研究等

2. 拉格朗日乘数法：对具有等式约束条件的函数进行优化。

3. 线性规划：用于在线性不等式约束条件下优化线性函数

4. 非线性规划：库恩 - 塔克方法。

## 线段：

要确定临界点的性质，一个重要的概念是凸函数和凹函数的概念。

### 定义 1：
设 $\mathbf{x}$ 和 $\mathbf{y}$ 是 $\mathbb{R^n}$ 中的两点。我们定义连接 x 和 y 的线段为以下集合
$$
\{(1-\lambda)\mathbf{x}+\lambda \mathbf{y} \mid 0\leq \lambda \leq 1\}
$$

该集合由连接点$\mathbf{x}$ 和 $\mathbf{y}$ 的直线上的点组成，即这些点位于“$\mathbf{x}$ 和 $\mathbf{y}$ 之间”。

### 定义 2：
在 $\mathbb{R}^n$ 中，集合 S 被称为凸集，当且仅当满足以下条件：
$$
\text{如果} \quad x,y \in S \quad \text{且}\quad 0\leq \lambda \leq 1 \quad \text{那么} \quad  (1-\lambda)x+\lambda y  \in S
$$

换句话说，如果集合中任意两点连接起来的直线上的点也属于该集合，那么该集合是凸集



注意：
$\mathbb{R}^n$、空集、仅含一个点的集合以及线段都是凸集。

由两个不同点组成的集合永远不是凸集。

实数集 R 的凸子集是各种区间，包括开区间、闭区间、半开区间、有界区间或无界区间。

以下是凸集

- $\{(x, y) \in \mathbb{R}^2 \mid x^2 + y^2 < 2\}$
- $\{(x, y) \in \mathbb{R}^2 \mid x, y \geq 0\};$
- $\{(x, y) \in \mathbb{R}^2 \mid x, y \geq 0,\ xy \geq 1\}.$

以下不是凸集

- $\{(x, y) \in \mathbb{R}^2 \mid x^2 + y^2 > 8\};$
- $\{(x, y) \in \mathbb{R}^2 \mid xy \leq 1\}.$



## 定义 3:

设 $f$ 是定义在凸集 $S$ 上的函数。

*   我们说函数 $f$ 在集合 $S$ 上是凸convex的，当且仅当
    
    $f((1 - \lambda)\mathbf{x} + \lambda\mathbf{y}) \leq (1 - \lambda)f(\mathbf{x}) + \lambda f(\mathbf{y})$
    
    对于所有的 $\mathbf{x}, \mathbf{y} \in S$ 以及所有的 $0 < \lambda < 1$。
    
*   我们说函数 $f$ 在集合 $S$ 上是严格凸的，当且仅当
    
    $f((1 - \lambda)\mathbf{x} + \lambda\mathbf{y}) < (1 - \lambda)f(\mathbf{x}) + \lambda f(\mathbf{y})$
    
    对于所有 $\mathbf{x}, \mathbf{y} \in S$ 且 $\mathbf{x} \neq \mathbf{y}$, 以及所有 $0 < \lambda < 1$。

## 定义 4:

设 $f$ 是定义在凸集 $S$ 上的函数。

*   我们说函数 $f$ 在集合 $S$ 上是凹concave的，当且仅当
    
    $f((1 - \lambda)\mathbf{x} + \lambda\mathbf{y}) \geq (1 - \lambda)f(\mathbf{x}) + \lambda f(\mathbf{y})$
    
    对于所有的 $\mathbf{x}, \mathbf{y} \in S$ 以及所有的 $0 < \lambda < 1$。
    
*   我们说函数 $f$ 在集合 $S$ 上严格凹，当且仅当
    
    $f((1 - \lambda)\mathbf{x} + \lambda\mathbf{y}) > (1 - \lambda)f(\mathbf{x}) + \lambda f(\mathbf{y})$
    
    对于所有 $\mathbf{x}, \mathbf{y} \in S$ 且 $\mathbf{x} \neq \mathbf{y}$, 以及所有 $0 < \lambda < 1$。



注意: 在上面两个定义中，要求函数是在凸集 S 上定义的，因为必须确保对于所有 $x, y \in S$ 以及所有 $0 < \lambda < 1$, 点 $(1 − \lambda)x + \lambda y$ 都位于 $S$ 上 (这样我们才能在这些点上定义 $f$)。

注: 对于严格凹concave函数，图象上任意两点之间的线段将严格位于图象下方 (端点除外)。 对于严格凸convex函数，该线段将严格位于图象上方。



**示例 3:**

线性函数

$f(\mathbf{x}) = a_1x_1 + a_2x_2 + ... + a_nx_n + b$

既是凸函数又是凹函数，但既不是严格凸函数也不是严格凹函数。



**注意:** 令

*   $B_f := \{(\mathbf{x}, y) \mid \mathbf{x} \in S \text{ and } y \leq f(\mathbf{x})\}$ 表示位于函数 $f$ 的图像下方的点的集合
*   $A_f := \{(\mathbf{x}, y) \mid \mathbf{x} \in S \text{ and } y \geq f(\mathbf{x})\}$ 表示位于函数 $f$ 的图像上方的点的集合

那么

$f \text{ is convex } \iff A_f \text{ is convex}$,

$f \text{ is concave } \iff B_f \text{ is convex}$.



对于最优化理论而言，一个重要结论为：

**Theorem 1:**

假设函数 $f$ 在凸集 $S$ 上具有连续的偏导数，设 $\mathbf{p}$ 为 $S$ 的内部点，则
如果函数 $f$ 是凸函数，那么 $f$ 在点 $\mathbf{p}$ 处取得最小值当且仅当 $\mathbf{p}$ 是一个临界点。
如果函数 $f$ 是凹函数，那么 $f$ 在点 $\mathbf{p}$ 处取得最大值当且仅当 $\mathbf{p}$ 是一个临界点。



## 二阶导数检验: 凸性和凹性

为了实际判断给定函数是凹函数、凸函数还是两者都不是，我们将采用二阶导数检验法。



对于二元函数，我们有以下两个定理

**定理 2:**

假设 $f$ 是平面上凸集 $S$ 上的一个函数，且其一阶和二阶偏导数连续，那么

*   函数 $f$ 是凸函数$\Leftrightarrow$ $f_{xx} \geq 0$, $f_{yy} \geq 0$ 且 $f_{xx} f_{yy} - f_{xy} f_{yx} \geq 0$。
*   函数 $f$ 是凹函数$\Leftrightarrow$ $f_{xx} \leq 0$, $f_{yy} \leq 0$ 且 $f_{xx} f_{yy} - f_{xy} f_{yx} \geq 0$。

其中不等式对 S 中的所有点都成立。



**定理 3:**

假设 f 是平面上凸集 S 上的一个函数，且其一阶和二阶偏导数连续，那么

*   当 $f_{xx} > 0$ 且 $f_{xx} f_{yy} - f_{xy} f_{yx} > 0 \Rightarrow $函数 $f$ 在 $S$ 内严格凸。
*   当 $f_{xx} < 0$ 且 $f_{xx} f_{yy} - f_{xy} f_{yx} > 0 \Rightarrow $函数 f 在 $S$ 内严格凹。

注: 请注意，第一个定理是充要条件的陈述，而第二个定理只是单向的。另一个方向 (通常) 不成立。



n 元变量的情况

关于二元函数凹凸性的结果可以推广到 n 元函数。

回想一下，函数 $f$ 的海森矩阵 $H$ 是 $f$ 的所有二阶偏导数组成的矩阵。

$$
H(x) = \begin{pmatrix}
f_{x_1 x_1}(x) & f_{x_1 x_2}(x) & f_{x_1 x_3}(x) & \cdots & f_{x_1 x_n}(x) \\
f_{x_2 x_1}(x) & f_{x_2 x_2}(x) & f_{x_2 x_3}(x) & \cdots & f_{x_2 x_n}(x) \\
f_{x_3 x_1}(x) & f_{x_3 x_2}(x) & f_{x_3 x_3}(x) & \cdots & f_{x_3 x_n}(x) \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
f_{x_n x_1}(x) & f_{x_n x_2}(x) & f_{x_n x_3}(x) & \cdots & f_{x_n x_n}(x) 
\end{pmatrix}
$$

并且它的顺序主子式（ leading principal minors, $ \Delta_k(x) = \det(H_k(x)) $）, 是前 $ k \times k $ 阶子阵的行列式 

$$
H_k(x) = \begin{pmatrix}
f_{x_1 x_1}(x) & f_{x_1 x_2}(x) & f_{x_1 x_3}(x) & \cdots & f_{x_1 x_k}(x) \\
f_{x_2 x_1}(x) & f_{x_2 x_2}(x) & f_{x_2 x_3}(x) & \cdots & f_{x_2 x_k}(x) \\
f_{x_3 x_1}(x) & f_{x_3 x_2}(x) & f_{x_3 x_3}(x) & \cdots & f_{x_3 x_k}(x) \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
f_{x_k x_1}(x) & f_{x_k x_2}(x) & f_{x_k x_3}(x) & \cdots & f_{x_k x_k}(x) 
\end{pmatrix}
$$

$ k = 1, \ldots, n $.



严格凸性的推导：

**定理 (二阶导数测试):** 
假设 $f$ 是定义在凸集 $S$ 上的函数，且其一阶和二阶偏导数连续，那么

- 如果对于所有的 $ k = 1, \ldots, n $ 以及所有的 $x \in S $，都有 $(-1)^k \Delta_k(x) > 0$成立，那么函数 $f$ 在 $S$ 内是严格凸的。

- 如果对于所有的 $ k = 1, \ldots, n $ 以及所有的 $x \in S $，都有 $\Delta_k(x) > 0$成立，那么函数 $f$ 在 $S$ 内是严格凹的。

第一个定理（关于凸性）也可以推广，但其表述会更复杂。现在我们来看看这两个判定准则背后的数学原理：即
正定矩阵：Positive Definite Matrix
半正定矩阵：Positive Semi-definite Matrix
负定矩阵：Negative Definite Matrix
半负定矩阵：Negative Semi-definite Matrix



**定义 5:** 
设 $ z$  是$ \mathbb{R}^n $ 中的一个列向量。则一个 $ n \times n $的对称矩阵 $ A$ 被称为是 

(i) **半正定矩阵positive semidefinite：** 如果对于所有的 $ z \in \mathbb{R}^n$，都有$ z^T A z \geq 0 $

(ii) 半负定矩阵**negative semidefinite：** 如果对于所有的 $ z \in \mathbb{R}^n$，都有$ z^T A z \leq 0 $

如果对于所有的 $ z \in \mathbb{R}^n $, $ z \neq 0 $, 上述不等式严格成立，（即不等号中的等号不成立），我们就称 A 是正定（或负定）的。



**定义 6:** 
设$ A$ 是一个  $n \times n$ 矩阵。

(i) $A$ 的 $k$ 阶顺序主子式是$A$ 的一个子阵的行列式：

$$
\Delta_k = \det(A_k) = \det \begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1k} \\
a_{21} & a_{22} & \cdots & a_{2k} \\
\vdots & \vdots & \ddots & \vdots \\
a_{k1} & a_{k2} & \cdots & a_{kk}
\end{pmatrix}
$$

(ii) 矩阵 $A$ 的 $k$ 阶主子式是指从 $A$ 中去掉 $n - k$  行及其对应的 $n - k$ 列后得到的$k \times k$阶子矩阵的行列式。

> [!NOTE]
>
> 对于主子式而言，考虑相应的列是很重要的！（不要与用于计算矩阵行列式的“余子式”概念相混淆）。
>
> - k阶子式：在行列式中任取k行k列组成的行列式，k行k列是任意组合没有限定要求，只要求行数列数相等
>
> - k阶主子式：也是选k行k列，但所选行和列下标要相同，例如：行为a1，a3，a6，则列要为b1，b3，b6
>
> - k阶顺序主子式：从第一行开始按顺序选k行，从第一列开始按顺序选k列
>
> - 余子式：在你n阶行列式中，划去aij所在的第i行和第j列的元素，将剩下的元素不改变原来的顺序所构成的n-1阶行列式成为aij的余子式，记作$m_{ij}$
> - 代数余子式：$a_{ij}$的代数余子式 $Aij=(-1)^{i+j}m_{ij}$



**注意:** 设矩阵  $A$ 是一个 $n \times n$ 阶矩阵。那么  $A$ 有$n$个顺序主子式 (leading
 principal minors)，$ \binom{n}{1} + \binom{n}{2} + \ldots + \binom{n}{n} = 2^n - 1 $个主子式(principal minors)。



**定理 4:** 
设$ A$ 是一个  $n \times n$ 阶对称矩阵，那么 $A$是
(i) **positive definite** 当且仅当对于所有 $1 \leq k \leq n$ ， 都有$\Delta_k > 0$.

(ii) **negative definite** 当且仅当对于所有  $1 \leq k \leq n$ ， 都有$(-1)^k \Delta_k > 0$



**定理 5:** 
设$ A$ 是一个  $n \times n$ 阶对称矩阵，那么A是

(i) **positive semidefinite**当且仅当对于所有  $1 \leq k \leq n$ 以及所有的 $k$ 阶主子式 $M_k$ (principal minor of order  $k $)， 都有$M_k \geq 0$

(ii) **negative semidefinite**当且仅当对于所有  $1 \leq k \leq n$ 以及所有的 $k$ 阶主子式 $M_k$ (principal minor of order  $k $)， 都有$(-1)^k M_k \geq 0$



一个 n 元函数 $f$ 的海森矩阵的正定/负定（半正定/半负定）性，会告诉我们 $f$ 是否为（严格）凸/凹函数。回想一下，函数 $f$ 的海森矩阵$ H$ 是
$$
H(x) = \begin{pmatrix}
f_{x_1 x_1}(x) & f_{x_1 x_2}(x) & f_{x_1 x_3}(x) & \cdots & f_{x_1 x_n}(x) \\
f_{x_2 x_1}(x) & f_{x_2 x_2}(x) & f_{x_2 x_3}(x) & \cdots & f_{x_2 x_n}(x) \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
f_{x_n x_1}(x) & f_{x_n x_2}(x) & f_{x_n x_3}(x) & \cdots & f_{x_n x_n}(x)
\end{pmatrix}.
$$

 k 阶顺序主子式(The leading principal minors) $ \Delta_k(x) = \det(H_k(x)) $, 是$ k \times k$阶子阵的行列式。 

$$
H_k(x) = \begin{pmatrix}
f_{x_1 x_1}(x) & f_{x_1 x_2}(x) & \cdots & f_{x_1 x_k}(x) \\
f_{x_2 x_1}(x) & f_{x_2 x_2}(x) & \cdots & f_{x_2 x_k}(x) \\
\vdots & \vdots & \ddots & \vdots \\
f_{x_k x_1}(x) & f_{x_k x_2}(x) & \cdots & f_{x_k x_k}(x)
\end{pmatrix},
$$

其中 $ k = 1, \ldots, n $.



**Theorem 6:**  

设函数 $f$ 定义在凸集 $S$ 上，具有一阶和二阶连续偏导数的函数，那么

(i) $f$ 是凸函数convex，当且仅当对于所有$x \in S $,海森矩阵是半正定的

$$
\Leftrightarrow M_k(x) \geq 0 \text{ for all } 1 \leq k \leq n \text{ and any principal minor } M_k(x) \text{ of order } k, \text{ for all } x \in S
$$

(ii)$f$ 是凹函数concave，当且仅当对于所有$x \in S $,海森矩阵是半负定的

$$
\Leftrightarrow (-1)^k M_k(x) \geq 0 \text{ for all } 1 \leq k \leq n \text{ and any principal minor } M_k(x) \text{ of order } k, \text{ for all } x \in S
$$

**Theorem 7:** 
设函数 $f$ 定义在凸集 $S$ 上，具有一阶和二阶连续偏导数的函数，那么

(i) 如果对于所有$x \in S $,海森矩阵是正定的

$$
(\Leftrightarrow \Delta_k(x) > 0 \text{ for all } 1 \leq k \leq n \text{ and all } x \in S)
$$

那么$f$是严格凸的strictly convex

(ii)如果对于所有$x \in S $,海森矩阵是负定的

$$
(\Leftrightarrow (-1)^k \Delta_k(x) > 0 \text{ for all } 1 \leq k \leq n \text{ and all } x \in S)
$$

那么$f$是严格凹的strictly concave


**注意:** 这些关于（严格）凸性/凹性的判断方法也适用于n=2时的情况

## 关于凸函数的重要说明

- 定义在开区间上的凸函数总是连续的。（证明略）

- 凸函数不一定可微。 例如, $ f : \mathbb{R} \to \mathbb{R} \quad  f(x) = |x| $ 是一个凸函数，但它在 0 处不可导。
- 当一个函数可微时，我们可以通过应用二阶导数检验（而无需使用定义）轻松地检查其凸性。

- 设 $f : S \to \mathbb{R} $  是一个连续的严格凸函数 ，且其偏导数也连续，并且$ S $ 是一个闭的有界凸集(closed and bounded convex set). 那么$f$ 在 $S$ 的边界上取得最大值。


# Chapter 8：准凸函数(Quasi-Convex Functions)的优化

目前已学

- 一个或多个变量，无约束函数的优化问题（一阶条件 $\nabla f (x) = 0$，使用 Hessian 矩阵的二阶导数测试，研究端点）。

- 使用拉格朗日乘子方法优化以等式为约束的函数。

- 线性规划优化以线性不等式为约束的线性函数。

- 非线性规划和 Kuhn-Tucker 方法。

- 凸函数的优化

## 准凹函数和准凸函数Quasi-concave and quasi-convex

凹函数和凸函数有几个有用的优化属性。然而，在现实生活（和经济学）中，有许多重要的函数既不是凹的也不是凸的。因此，我们将研究准凹函数和准凸函数。我们使用 “quasi” （“几乎”， “as if”，来自拉丁语），因为这里的条件不那么严格。

## Level sets: 水平集和Upper level sets: 上水平集

为了定义准凹函数，我们需要引入函数的上水平集。

定义 1：设 $f$ 是在$\mathbb{R}^n$ 中的集合 $S$ 上定义的函数。对于每个实数 $a$，我们定义：

$f $ 的水平集 $C_a$为：
$$
C_a = \{ \mathbf{x} \in S \mid f(\mathbf{x}) = a \} \subset S.
$$

$f$ 的上水平集 $P_a$为
$$
P_a = \{ \mathbf{x} \in S \mid f(\mathbf{x}) \geq a \} \subset S.
$$

$f$ 的下水平集 $L_a$为
$$
L_a = \{ \mathbf{x} \in S \mid f(\mathbf{x}) \leq a \} \subset S.
$$

不要把他们与下面的集合混淆：
- $ A_f = \{ (\mathbf{x}, y) \in S \times \mathbb{R} \mid f(\mathbf{x}) \geq y \} \subset S \times \mathbb{R} $
- $ G_f = \{ (\mathbf{x}, y) \in S \times \mathbb{R} \mid f(\mathbf{x}) > y \} \subset S \times \mathbb{R} $
- $ B_f = \{ (\mathbf{x}, y) \in S \times \mathbb{R} \mid f(\mathbf{x}) \leq y \} \subset S \times \mathbb{R} $

定义 2：在凸集 $S \in \mathbb{R}^n$ 上定义的函数 $f$ 。如果对于每个$a\in R$，上水平集 $P_a$都是凸的，那么函数 $f$ 是准凹的

如果 $−f$ 是准凹的，则函数 $f$ 是准凸的。

注意：

如果一个函数是凹的，那么它总是准凹的。

如果函数是准凹函数，则它不必是凹函数。

凸函数可以是准凹的！例如，$f (x) = − \ln x 在 {x \in  \mathbb{R} ∶ x > 0}$ 上是凸和准凹的。

### Theorem 1:
设 f 是定义在凸集 $S \subset  \mathbb{R}^n$ 上的包含 $n$ 个变量的函数。那么当且仅当对于 $x, x_0 \in S$ 和所有 $\lambda \in [0， 1]$ 我们有

$$
f(\mathbf{x}) \geq f(\mathbf{x_0}) \implies f\left((1 - \lambda)\mathbf{x} + \lambda \mathbf{x_0}\right) \geq f(\mathbf{x_0}).
$$
时，$f$ 是准凹的quasi-concave

如果我们的函数有二阶偏导数，那么我们可以使用更简单的方法检查准凹度：我们需要考虑边框海森矩阵bordered Hessians

用于检查函数凹度的边框海森矩阵比普通 Hessian 矩阵多了额外的一行和一列，分别包含函数的一阶偏导数。

也就是说，我们考虑 $(n + 1) \times (n + 1)$ 阶矩阵

$$
\begin{pmatrix}
0 & f_{x_1}(x) & f_{x_2}(x) & f_{x_3}(x) & \cdots & f_{x_n}(x) \\
f_{x_1}(x) & f_{x_1x_1}(x) & f_{x_1x_2}(x) & f_{x_1x_3}(x) & \cdots & f_{x_1x_n}(x) \\
f_{x_2}(x) & f_{x_2x_1}(x) & f_{x_2x_2}(x) & f_{x_2x_3}(x) & \cdots & f_{x_2x_n}(x) \\
f_{x_3}(x) & f_{x_3x_1}(x) & f_{x_3x_2}(x) & f_{x_3x_3}(x) & \cdots & f_{x_3x_n}(x) \\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots \\
f_{x_n}(x) & f_{x_nx_1}(x) & f_{x_nx_2}(x) & f_{x_nx_3}(x) & \cdots & f_{x_nx_n}(x)
\end{pmatrix}
$$

此外，我们考虑子矩阵的行列式（类似于我们对 Hessian 矩阵所做的）：

$$
D_k(x) = \det \begin{pmatrix}
0 & f_{x_1}(x) & f_{x_2}(x) & \cdots & f_{x_n}(x) \\
f_{x_1}(x) & f_{x_{1x_1}}(x) & f_{x_{1x_2}}(x) & \cdots & f_{x_{1x_n}}(x) \\
f_{x_2}(x) & f_{x_{2x_1}}(x) & f_{x_{2x_2}}(x) & \cdots & f_{x_{2x_n}}(x) \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
f_{x_n}(x) & f_{x_{nx_1}}(x) & f_{x_{nx_2}}(x) & \cdots & f_{x_{nx_n}}(x)
\end{pmatrix}
$$

for $ k = 1, \ldots, n $.

### Theorem 2:
设$ f$ 为凸集$ S \subset \mathbb{R}^n$ 上的函数。如果

$$
(-1)^k D_k(x) > 0
$$

对于所有 $x \in S$ 以及 $k = 1, \ldots, n$ 成立, 那么 $f$  在 $S$ 上是准凹的。quasi-concave

我们考虑函数：
$$
Y(K, L) = AK^a L^b
$$
for $ A > 0, a > 0, b > 0 \quad K, L > 0$ 


这个函数称为 Cobb-Douglas 函数，在经济学中有多种应用。

$K$ ： capital input 资本投入 （所有技术设备、建筑物等的价值）。

$L$：labor input 劳动投入（一年内工作的总工时数） 

$A、a、b$:  参数，取决于某些条件（例如技术或经济条件）。参数 $a$ 和 $b$ 称为“弹性”，表示公司拥有更多资本而不是劳动力（取决于可用技术）的重要性。

$Y(K, L)$ ：总生产量（一年内生产的所有商品的价值）。如果我们使用 $K$ 个资本单位和 $L$ 个劳动单位

因此，对于一家公司来说，知道应该使用多少个单位的资本 $K$ 和劳动力 $L$ 来最大化生产 $Y(K, L)$ 非常重要。

我们已经看到，如果 $a + b \leq  1$，则此函数为凹函数，如果 $a + b < 1$，则此函数为严格凹函数。

如果 $a + b = 1$，我们说生产函数是“规模报酬不变”的，
如果 $a + b < 1$，我们说它“规模报酬递减”。

我们现在检查准凹度，我们将看到 $Y$ 对于所有 $a、b > 0$ 都是准凹的。

带边框的 Hessian 矩阵是

$$
\begin{pmatrix}
0 & aAK^{a-1}L^b & a(a-1)K^{a-2}L^b \\
bAK^{a}L^{b-1} & abAK^{a-1}L^{b-1} & abK^{a-1}L^{b-2} \\
b(a-1)AK^{a-2}L^b & bAK^{a-1}L^{b-2} & 0
\end{pmatrix}
$$

所以

$$
D_1(K, L) = \left| 
\begin{array}{ccc}
0 & aAK^{a-1}L^b  \\
bAK^{a}L^{b-1} & abAK^{a-1}L^{b-1} 
\end{array}
\right| = -a^2 A^2 K^{2a-2} L^{2b}.
$$

对于 $D_2(K, L)$ , 如果我们将第一列除以 $AK^a L^b$, 第二列除以 $AK^{a-1}L^b$ 第三列除以 $bAK^a L^{b-1}$, 则我们得到

$$
D_2(K, L) = abA^3 K^{3a-1} L^{3b-1} 
\begin{vmatrix}
0 & 1 & 1 \\
aK^{a-1} & (a-1)K^{-1} & aK^{a-1} \\
b L^{-1} & b L^{-1} & (b-1) L^{-1}
\end{vmatrix}.
$$

现在将第 2 行和第 3 行分别乘以 $K$ 和 $L$，可以得到

$$
D_2(K, L) = abA^3 K^{3a-2} L^{3b-2} 
\begin{vmatrix}
0 & 1 & 1 \\
a & a-1 & a \\
b & b & b-1
\end{vmatrix}= ab(a + b)A K^{3a-2} L^{3b-2}.
$$

因为 $a, b > 0$， 所以我们得到： 

$$
-D_1(K, L) = a^2 A^2 K^{2a-2} L^{2b} > 0,
$$

$$
D_2(K, L) = ab(a + b)A^3 K^{3a-2} L^{3b-2} > 0.
$$

因此，Y 是准凹的。

### Definition 3:
n元变量的Cobb-Douglas 方程定义如下 

$$
z = A x_1^{a_1} x_2^{a_2} \cdots x_n^{a_n} \\
(x_1, x_2, \ldots, x_n > 0)
$$

其中 $ A, a_1, a_2, \ldots, a_n > 0$ .

检查Cobb-Douglas方程的（准）凸性，我们会发现：

1. $ a_1 + a_2 + \ldots + a_n \leq 1 $时是凹的
2. $ a_1 + a_2 + \ldots + a_n < 1 $是严格凹的
3. $a_1, a_2, \ldots, a_n > 0 $时是准凹的



### Quasi-concavity of the Cobb-Douglas function

为了证明该函数是准凹函数，我们必须确定有边框的 Hessian：

$$
\frac{\partial z}{\partial x_i} = \frac{a_i z}{x_i} \\
\frac{\partial^2 z}{\partial x_i \partial x_j} = \frac{a_i a_j z}{x_i x_j}, \quad \text{if } i \neq j \\
\frac{\partial^2 z}{\partial x_i^2} = \frac{a_i (a_i - 1) z}{x_i^2},
$$

所以，有边界的 Hessian是：

$$
\begin{pmatrix}
0 & a_1 x_1^{a_1 - 1} z & a_2 x_2^{a_2 - 1} z & \cdots & a_n x_n^{a_n - 1} z \\
a_1 x_1^{a_1 - 1} z & \frac{a_1 (a_1 - 1) z}{x_1^2} & \frac{a_1 a_2 z}{x_1 x_2} & \cdots & \frac{a_1 a_n z}{x_1 x_n} \\
a_2 x_2^{a_2 - 1} z & \frac{a_2 a_1 z}{x_2 x_1} & \frac{a_2 (a_2 - 1) z}{x_2^2} & \cdots & \frac{a_2 a_n z}{x_2 x_n} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
a_n x_n^{a_n - 1} z & \frac{a_n a_1 z}{x_n x_1} & \frac{a_n a_2 z}{x_n x_2} & \cdots & \frac{a_n (a_n - 1) z}{x_n^2}
\end{pmatrix}.
$$


### Submatrices

对于$ k = 1, 2, \ldots, n $ 我们考虑

$$
D_k = \det \begin{pmatrix}
0 & a_1 z & a_2 z & \cdots & a_k z \\
a_1 (x_1^{a_1 - 1}) z & a_1 a_1 z & a_1 a_2 z & \cdots & a_1 a_k z \\
a_2 (x_2^{a_2 - 1}) z & a_2 a_1 z & a_2 a_2 z & \cdots & a_2 a_k z \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
a_k (x_k^{a_k - 1}) z & a_k a_1 z & a_k a_2 z & \cdots & a_k a_k z
\end{pmatrix}.
$$

如果我们将第一列除以 z ， 将第 (i+1)  列除以 $ \frac{a_i z}{x_i} (i = 1, \ldots, k) $, 可以得到：

$$
D_k(x) = \frac{a_1 a_2 \cdots a_k}{x_1 x_2 \cdots x_k} z^{k+1} \det \begin{pmatrix}
0 & 1 & 1 & \cdots & 1 \\
\frac{a_1}{x_1} & \frac{a_1 - 1}{x_1} & \frac{a_1}{x_1} & \cdots & \frac{a_1}{x_1} \\
\frac{a_2}{x_2} & \frac{a_2}{x_2} & \frac{a_2 - 1}{x_2} & \cdots & \frac{a_2}{x_2} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
\frac{a_k}{x_k} & \frac{a_k}{x_k} & \frac{a_k}{x_k} & \cdots & \frac{a_k - 1}{x_k} \\
\end{pmatrix}.
$$


### Submatrices

如果将第 $ (i+1) $ 行乘上 $ x_i (i = 1, \ldots, k) $，将得到

$$
D_k(x) = \frac{a_1 a_2 \cdots a_k}{(x_1 x_2 \cdots x_k)^2} z^{k+1} \det 
\begin{pmatrix}
0 & 1 & 1 & \cdots & 1 \\
a_1 & a_1 - 1 & a_1 & \cdots & a_1 \\
a_2 & a_2 & a_2 - 1 & \cdots & a_2 \\
\vdots & \vdots & \vdots & \ddots & \vdots\\
a_k & a_k & a_k & \cdots & a_k - 1
\end{pmatrix}
$$

如果从第  $(i+1)$行中减去 $ a_i$倍的第一行，我们会得到

$$
D_k(x) = \frac{a_1 a_2 \cdots a_k}{(x_1 x_2 \cdots x_k)^2} z^{k+1} \det 
\begin{pmatrix}
0 & 1 & 1 & \cdots & 1 \\
a_1 & -1 & 0 & \cdots & 0 \\
a_2 & 0 & -1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots\\
a_k & 0 & 0 & \cdots & -1
\end{pmatrix}
$$


### Submatrices

现在将第 2 行到第 $k + 1$ 行加到第一行上，我们将得到

$$
D_k(x) = \frac{a_1 a_2 \cdots a_k}{(x_1 x_2 \cdots x_k)^2} z^{k+1} \det \begin{pmatrix}
a_1 + \ldots + a_k & 0 & 0 & \ldots & 0 \\
a_1 & -1 & 0 & \ldots & 0 \\
a_2 & 0 & -1 & \ldots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots\\
a_k & 0 & 0 & \ldots & -1
\end{pmatrix}
$$

我们现在得到的矩阵是一个下三角矩阵，它的行列式是对角线元素的乘积，所以

$$
D_k(x) = (-1)^k \frac{a_1 a_2 \cdots a_k}{(x_1 x_2 \cdots x_k)^2} z^{k+1} (a_1 + a_2 + \ldots + a_k).
$$

由此可以看出，对于所有的 $x_1, x_2, \ldots, x_n > 0 $ 和 $ k = 1, 2, \ldots, n $,  Cobb-Douglas 是准凹的quasi-concave.



如果我们想要检查 Cobb-Douglas 函数的凹性，我们必须考虑 Hessian矩阵
$$
H = \begin{pmatrix}
\frac{a_1 (a_1 - 1)}{x_1^2} z & \frac{a_1 a_2}{x_1 x_2} z & \cdots & \frac{a_1 a_k}{x_1 x_k} z \\
\frac{a_2 a_1}{x_2 x_1} z & \frac{a_2 (a_2 - 1)}{x_2^2} z & \cdots & \frac{a_2 a_k}{x_2 x_k} z \\
\vdots & \vdots & \ddots & \vdots \\
\frac{a_k a_1}{x_k x_1} z & \frac{a_k a_2}{x_k x_2} z & \cdots & \frac{a_k (a_k - 1)}{x_k^2} z
\end{pmatrix}
$$

$ k = 1, 2, \ldots, n $

$$
\Delta_k(x) = \det \begin{pmatrix}
\frac{a_1 (a_1 - 1)}{x_1^2} z & \frac{a_1 a_2}{x_1 x_2} z & \cdots & \frac{a_1 a_k}{x_1 x_k} z \\
\frac{a_2 (a_2 - 1)}{x_2^2} z & \frac{a_2 a_1}{x_2 x_1} z & \cdots & \frac{a_2 a_k}{x_2 x_k} z \\
\vdots & \vdots & \ddots & \vdots \\
\frac{a_k (a_k - 1)}{x_k^2} z & \frac{a_k a_1}{x_k x_1} z & \cdots & \frac{a_k a_k}{x_k^2} z
\end{pmatrix}
$$

用与上面对边框矩阵采用的相似方法，我们得到：

$$
\Delta_k(x) = (-1)^k \frac{a_1 a_2 \cdots a_k}{(x_1 x_2 \cdots x_k)^2} z^k \{ 1 - (a_1 + a_2 + \ldots + a_k) \}
$$

如果$ a_1 + a_2 + \ldots + a_k < 1 $ 那么

$$
a_1 + a_2 + \ldots + a_k < 1 \quad \text{for } k = 1, 2, \ldots, n,
$$

并且：

$$
(-1)^k \Delta_k(x) > 0 \quad \text{for all } x_1, x_2, \ldots, x_n > 0 \text{ and } k = 1, 2, \ldots, n,
$$



因此，使用二阶导数检验，我们看到 Cobb-Douglas 函数是严格凹的。strictly concave.

可以得出结论：变量多于两个的情况下，如果$a_1 + a_2 + \ldots + a_n \leq 1$，那么Cobb-Douglas 方程是凹的

---



# PS1:

## Question1

Find the absolute maximum and the absolute minimum of the function $g(x) = \ln(x^2 + x + 1)$ on the  interval $[-1, 1]$.



**Solution：**  

$\ln$  函数在 $(0, +\infty )$ 是连续的且可微分无限次 continuous and differentiable infinitely many times in
所以 $g(x)$ 可微分无限次，如果：
$$
x^2+x+1>0
$$


因为
$$
△<0
$$
所以
$$
x^2+x+1>0
$$

所以 $g ( x )$ 是可微分函数的复合函数 ， $g ( x )$ 在 $\R$ 上可微分。

> **关键在于连续且可导，包括对定义域的讨论．**

- 讨论一阶导数：

$$
g '( x )= x + x +1
$$

| $x$     | $[-1,-\dfrac{1}{2})$ | $-\dfrac{1}{2}$ | $(-\dfrac{1}{2},1]$ |
| ------- | -------------------- | --------------- | ------------------- |
| $g'(x)$ | $-$                  | $0$             | $+$                 |
| $g(x)$  | decrease             | local minimum   | increase            |


$$
g (-\dfrac{1}{2})= \ln (\dfrac{3}{4})
$$


- 讨论端点 (endpoint）：
  $$
  g (-1)= \ln (1)=0 \\
  g (1)= \ln (3)
  $$
  
- 综合以上信息：

$$
g (-\dfrac{1}{2})<g (-1)<g (1)
$$

- 结论：

  

$x =-\dfrac{1}{2}$ is absolute minimum, at this point, $g(x)$ attains $\ln (\dfrac{3}{4})$

$x =1$ is absolute maximum, at this point, $g(x)$ attains $\ln3$



---



## Question2

Consider the function $f(x) = x^4 +8x^3$, defined for all $x$ in $R$.
(a) Find the critical points of $f$.
(b) Find in which intervals $f$ is increasing or decreasing.
(c) Find the local maxima and the local minima of $f$.
(d) Find in which intervals $f$ concaves up or down.
(e) Find the inflection points of $f$.



**Solution:**

(a) Since f(x) a polynomial , it it differentiable infinitely many times ,

一阶导为0的点是 critical point
$$
f '( x )=4x^3 + 24x^2=0
$$
解得：
$$
\left\{
\begin{array}{l}
x_1 =0 \\
x_2=-6
\end{array}
\right.
$$

(b) 讨论一阶导

| $x$     | $(-\infty,-6)$ | $-6$          | $(-6,0)$ | 0    | $(0,+\infty)$ |
| ------- | -------------- | ------------- | -------- | ---- | ------------- |
| $f'(x)$ | $-$            | $0$           | $+$      | $0$  | $+$           |
| $f(x)$  | decrease       | local minimum | increase |      | increase      |



(c) 

$x=-6$ is a local minima, $f(x)$ attaints -432

there is no local minima.



(d)

讨论二阶导：

| $x$      | $(-\infty,-4)$ | $-4$ | $(-4,0)$     | 0    | $(0,+\infty)$ |
| -------- | -------------- | ---- | ------------ | ---- | ------------- |
| $f''(x)$ | $+$            | $0$  | $-$          | $0$  | $+$           |
| $f(x)$   | concave up     |      | concave down |      | concave up    |



(e)

$x=0$ and $x=-4$ are inflection points



---



## Question3
Show that the curve $f(x) = \dfrac{x^2 +x+1}{(x+1)^2}$ has a local minimum point at $x = 1$.

 

## Solution:

讨论一阶导数：
$$
f'(x)=\dfrac{x-1}{(x+1)^2} \quad \text{where}\quad x≠ -1 
$$


| $x$     | $(-\infty,-1)$ | $-1$         | $(-1,1)$ | $1$          | $(1, +\infty)$ |
| ------- | -------------- | ------------ | -------- | ------------ | -------------- |
| $f'(x)$ | $+$            | $0$          | $-$      | $0$          | $+$            |
| $f(x)$  | increase       | local maxima | decrease | local minima | increase       |



so $x=1$ is local minima, where $f(x)$ attains $\dfrac{3}{4}$



---



## Question4

It is given the function $f(x) = (x-1)^3(x+1)^2$
(i) Find and classify all the critical points of the function.
(ii) Find the inflection point(s), if any.



## Solution:

(i)
$$
f'(x)=\dfrac{(x+5)(x-1)^2}{(x+1)^3}\quad \text{where} \quad x≠-1
$$
令：
$$
f'(x)=0
$$
解得：
$$
\left\{
\begin{array}{l}
x_1 =-5 \\
x_2=1
\end{array}
\right.
$$
这就是可能的critical point。

| $x$     | $(-\infty,-5)$ | $-5$         | $(-5,-1)$ | $-1$       | $(-1, 1)$ | $1$  | $(1,+\infty)$ |
| ------- | -------------- | ------------ | --------- | ---------- | --------- | ---- | ------------- |
| $f'(x)$ | $+$            | $0$          | $-$       | $\nexists$ | $+$       | $0$  | $+$           |
| $f(x)$  | increase       | local maxima | decrease  | $\nexists$ | increase  |      | increase      |



所以：

x=-5 是 local maxima

x=1 是 inflection point 且此处函数斜率为0



(ii)
$$
f''(x)=\dfrac{24(x-1)}{(x+1)^4}
$$
二阶导为零的点是inflection point

所以 x=1 是inflection point



---



## Question5

It is given the function$ f(x) = sin(x)$.
(i) Find and classify all the critical points of the function.
(ii) Find the inflection point(s), if any.



## Solution:

(i)
$$
f'(x)=cos(x) \\
\Downarrow \\
f'(x)=0 \\
\Downarrow \\
x=\dfrac{\pi}{2}+\pi k \quad k∈ \Z
$$
这些都是极值点
$$
f''(x)=-sin(x) \\

f''(\dfrac{\pi}{2}+2k\pi)=-1 \\

f''(\dfrac{3\pi}{2}+2k\pi)=1 \\
$$
所以：

$x=\dfrac{\pi}{2}+2k\pi$ 是local maxima

$x=\dfrac{3\pi}{2}+2k\pi$ 是local minima



(ii)
$$
f''(x)=-sin(x) \\
\\
f''(x)=0 \\
\\
x=k\pi \\
$$
这些点是inflection points



---



## Question6

A 1-litre can is to be designed in the shape of a right circular cylinder. What dimension will use the least material?



## Solution：

设r为半径，h为高

体积：$V=πr^2h$ 

面积：$A=2πr^2+2πrh$

由（1）得：$h=\dfrac{1000}{πr^2}$

带入（2）得：$A=2πr^2 + 2πr\dfrac{1000}{πr^2}=2πr^2+\dfrac{1000}{r}$

$A'(r)=4πr-\dfrac{2000}{r^2}=0$

$r^3=\dfrac{500}{π}$

$r=\sqrt[3]{\dfrac{500}{π}}$

所以A的最小值是：
$$
A=2π(\dfrac{500}{π})^{\frac{2}{3}}+\dfrac{2000}{\sqrt[3]{\frac{500}{π}}}
$$


---



## Question7

Find and classify all critical points of the following functions:\\
(i) $g(x,y) = 3x^2 +xy-x+y^2$
(ii) $f(x,y) = x^3 +y^3-3x-12y$
(iii) $h(x,y,z) = 8-3x^2-y^2-(z-1)^2$

solution:

(i) g is polynomial so infinitely many time differentiable
$$
∇g =(\dfrac{∂g}{∂x},\dfrac{∂g}{∂y})=(0,0)
$$

$$
\left\{\begin{array}{l}
\dfrac{∂g}{∂x}=6x+y-1=0 \\
\dfrac{∂g}{∂y}=x+2y=0
\end{array}\right.
$$

$$
\left\{
\begin{array}{l}
x=\dfrac{2}{11} \\
y=-\dfrac{1}{11}
\end{array}
\right.
$$

$$
H_g(x,y)= \begin{pmatrix} g_{xx} & g_{xy}\\ g_{yx} & g_{yy} \end{pmatrix}
$$

$$
H_g(\dfrac{2}{11},-\dfrac{1}{11})= \begin{pmatrix} 6 & 1\\ 1 & 2 \end{pmatrix}
$$

$$
\left\{
\begin{array}{l}
∆_1=6 \\
∆_2=11
\end{array}
\right.
$$

$∆_1 , ∆_2$ are both positive so$(\dfrac{2}{11},-\dfrac{1}{11}) $is a critical point by second partial derivative test.

(ii)
$$
∇f =(\dfrac{∂f}{∂x},\dfrac{∂f}{∂y})=(0,0)
$$


$$
\left\{\begin{array}{l}\dfrac{∂f}{∂x}=3x^2-3=0 \\\dfrac{∂f}{∂y}=3y^2-12=0\end{array}\right.
$$


$$
\left\{
\begin{array}{l}
x=±1 \\
y=±2
\end{array}
\right.
$$


$$
(x,y)∈{(1,2),(1,-2),(-1,2),(-1,-2)}
$$

to classify these critical points we need hessian matrix
$$
H_g(x,y)= \begin{pmatrix} g_{xx} & g_{xy}\\ g_{yx} & g_{yy} \end{pmatrix}= \begin{pmatrix} 6x & 0\\ 0 & 6y \end{pmatrix}
$$

$$
\left\{
\begin{array}{l}
∆_1=6x \\
∆_2=36xy
\end{array}
\right.
$$

at (-1,2) and (1,-2)



（iii）
$$
\left\{\begin{array}{l}
h_x=-6x \\
h_y=-2y \\
h_z=2-2z \\
\end{array}\right.
$$

$$
∇g =(h_x,h_y,h_z)=(0,0,0) \\
\Downarrow \\
\left\{\begin{array}{l}
x=0 \\
y=0 \\
z=1 \\
\end{array}\right.
$$

$$
H_g(x,y)= 
\begin{pmatrix} 
h_{xx} & h_{xy} & h_{xz} \\ 
h_{yx} & h_{yy} & h_{yz} \\ 
h_{zx} & h_{zy} & h_{zz} \\
\end{pmatrix}
= 
\begin{pmatrix}
-6 & 0 & 0 \\ 
0 & -2 & 0 \\ 
0 & 0 & 0 \\ 
\end{pmatrix}
$$


$$
\left\{
\begin{array}{l}
∆_1(0,0,1)=-6<0 \\
∆_2(0,0,1)=12>0 \\
∆_2(0,0,1)=-24<0 \\
\end{array}
\right.
$$


根据二阶导数检测，该点是maximum



---



## Question8

Let $f(x,y) = cos(x)sin(y)$.

(i) Compute the Hessian matrix of $f$ and all its leading principal minors.

(ii) Show that $(0, \dfrac{\pi}{2})$ is a critical point of $f$.

(iii) Use the second derivative test to investigate if at $(0, \dfrac{\pi}{2})$ the function $f$ has a local maximum or a local minimum or a saddle point.



## Solution:

(i)
$$
H_f(x,y)= \begin{pmatrix} f_{xx} & f_{xy}\\ f_{yx} & f_{yy} \end{pmatrix}=\begin{pmatrix} -cos(x)sin(y) & -sin(x)cons(y)\\ -sin(x)cons(y) & -cos(x)sin(y) \end{pmatrix}
$$

$$
\left\{
\begin{array}{l}
∆_1(x,y)=-cos(x)sin(y) \\
∆_2(x,y)=cos^2(x)sin^2(y)-sin^2(x)cos^2(y)
\end{array}
\right.
$$



(ii)
$$
∇f =(f_x,f_y)=\{sin(x)sin(y), \quad cos(x)cos(y)\} \\
∇f =(0,\dfrac{\pi}{2})=(0,0)
$$
所以 $(0,\dfrac{\pi}{2})$ 是critical point



(iii)
$$
\left\{
\begin{array}{l}
∆_1(0,\dfrac{\pi}{2})=-cos(0)sin(\dfrac{\pi}{2})=-1<0 \\
∆_2(0,\dfrac{\pi}{2})=cos^2(0)sin^2(\dfrac{\pi}{2})-sin^2(0)cos^2(\dfrac{\pi}{2})=1>0
\end{array}
\right.
$$
根据二阶导数检测，所以 $(0,\dfrac{\pi}{2})$ 是maximum point

---



## Question9

Find the critical points of the 3 given functions and mark their location in the corresponding graph. Use these graphs to characterize each critical point as a local maximum or a local minimum or a saddle point.

(i)
$$
∇f =(f_x,f_y)=\{-sin(x)sin(y), \quad cos(x)cos(y)\} \\
∇f =(0,0)
$$

$$
sin(x)=0 \Rightarrow x=\pi k \\
\\
sin(y)=0 \Rightarrow y=\pi k \\
\\
cos(x)=0 \Rightarrow x=\dfrac{2}{\pi} + \pi k \\
\\
cos(y)=0 \Rightarrow y=\dfrac{2}{\pi} + \pi k \\
$$

所以：

$(\dfrac{2}{\pi} + \pi k , \pi k)$ 

$(\pi k , \dfrac{2}{\pi} + \pi k)$

都是极值点



(ii)
$$
∇g =(g_x,g_y)=\{ye^{xy} e^{e^{xy}}, \quad xe^{xy} e^{e^{xy}} \}\\
\\
∇g =(0,0) \\
\\
\left\{\begin{array}{l}
x=0 \\
y=0 \\
\end{array}\right.
$$
(0,0)是唯一的极值点，从图中可以看出，这是一个鞍点



(iii)
$$
∇h =(h_x,h_y)=\{y^3, 3xy^2 \}\\
\\
∇h =(0,0) \\
\\
y=0 \\
$$
所以 $y=0$ 这条直线上的所有点都是极值点，可以看出这些点都是鞍点



---



# PS2：

## Question 1: 

For the following LP problem sketch the feasible set, find all corner points and use the graphical method to solve it: 

Maximize ：
$$
8x_1 +9x_2
$$
subject to ：
$$
x_1 +2x_2 ≤ 8, \\ 

2x_1 +3x_2 ≤ 13, \\

x_1 +x_2 ≤ 6, \\ 

x_1 ≥ 0, x_2 ≥ 0.
$$

**Solution:**

The maximum value is 49. This is attained at (x1,x2) = (5,1). 

![ps2q1](LP图像/ps2q1.png)



---



## Question 2:

 Let λ >0 be a constant. Sketch the feasible set F determined by the inequalities: 
$$
x_1+x_2 ≤ λ, \\

x_1 ≥ 0, x_2 ≥ 0.
$$
Also maximize and minimize the function 
$$
f(x_1,x_2) = 2x_1 −2x_2
$$




### Solution: 

The maximum value is $2\lambda$, attained at $(x_1,x_2) = (\lambda,0)$. The minimum value is $−2\lambda$, attained at $(x_1,x_2) = (0,\lambda)$. 

---



## Question 3: 

The region B consists of all (x1,x2) satisfying 
$$
x_1 −2x_2 ≤ 2, \\

2x_1 +x_2 ≤ 8, \\

x_1 ≥ 0, x_2 ≥ 0.
$$
Solve the following problems with B as the feasible region: 

(1) $max. 3x_1 $

(2) $max. 2x_1 +3x_2$ 

(3) $min. −2x_1 −3x_2$ 



### Solution:

(a) The maximum value is 10.8, attained at (x1,x2) = (3.6,0.8). 

![Solution3a](LP图像/Solution3a.png)



(b) The maximum value is 8, attained at(x1,x2) = (0,8). 

![Solution3b](LP图像/Solution3b.png)



(c) The minimm value is −24, attained at (x1,x2) = (0,8). □ 

![Solution3c](LP图像/Solution3c.png)



---



## Question 4: 

A doctor wants to design a breakfast menu for his patients. The menu is to include two items A and B which provide a number of units of vitamin C and iron as given in the table below :

| item | units of vitamin C (per gram) | units of zinc (per gram) | Cost per gram |
| ---- | ----------------------------- | ------------------------ | ------------- |
| A    | 2                             | 2                        | $4            |
| B    | 1                             | 2                        | $3            |

the breakfast menu must provide at least 8 units of vitamin C and 10 units of zinc. 

(a) How many grams of each item should be provided in order to meet the zinc and vitamin C requirements for the minimum cost? What will this breakfast cost? 

(b) Now suppose the cost of Item B rises to $4 per gram. What is the new minimum cost of the breakfast? Describe all the possible set of breakfasts which achieve this minimum cost.



### Solution:

1).

最小化：
$$
f=4x+3y
$$
约束条件：
$$
2x+y≥8, \\
2x+2y≥10, \\
x≥0, y≥0.
$$
f 在 (3,2)处达到最小值18 

![](LP图像/Solution4a.png)



2).

最小化：
$$
f=4x+4y
$$

$$
2x+y≥8, \\
2x+2y≥10, \\
x≥0, y≥0.
$$

 f 在 (3,2) 和 (5,0) 处达到最小值20 

![Solution4b](LP图像/Solution4b.png)

---



# PS3:



## Question 1: 

Use the method of Lagrange multipliers to find the maximum and minimum of $f(x,y) = 5x^2 +5y^2 +1$  subject to the constraint $xy = 1$. 



**Solution:** 
$$
\left\{\begin{array}{l}
\nabla f=\lambda \nabla g \\
g(x,y)=c
\end{array}\right.
\\
\Downarrow
\\
\left\{\begin{array}{l}
10x=\lambda y
\\
10y=\lambda x
\\
xy=1
\end{array}\right.
\\
\Downarrow
\\
\left\{\begin{array}{l}
100xy=\lambda^2 xy
\\
10y=\lambda x
\\
xy=1
\end{array}\right.
$$


$$
\left\{\begin{array}{l}
100=\lambda^2
\\
10y=\lambda x
\\
xy=1
\end{array}\right.
$$

case 1:

$$
\left\{\begin{array}{l}
\lambda=10
\\
10y=10x
\\
xy=1
\end{array}\right.
\\
\Downarrow
\\
\left\{\begin{array}{l}
\lambda=10
\\
y=x
\\
x^2=1
\end{array}\right.
$$

case 2:

$$
\left\{\begin{array}{l}
\lambda=-10
\\
10y=-10x
\\
xy=1
\end{array}\right.
\\
\Downarrow
\\
\left\{\begin{array}{l}
\lambda=-10
\\
y=-x
\\
x^2=-1 \quad \text{舍弃}
\end{array}\right.
$$

所以：
$$
\left\{\begin{array}{l}
x=1
\\
y=1
\end{array}\right.
\\
\Downarrow
\\
\left\{\begin{array}{l}
x=-1
\\
y=-1
\end{array}\right.
$$

易得：
$$
f(1,1)=11
\\
f(-1,-1)=11
$$

判断此二点是最小还是最大：
数形结合法：
$$
f(x,y)=5x^2 +5y^2 +1=5(\sqrt{x^2+y^2})^2+1
$$
函数 $f$ 的值代表坐标系内的点到原点的距离的平方的5倍加1

约束为
$$
xy = 1
$$

表示点 $(x,y)$ 在反比例函数曲线上。

可得：
曲线上的点到到原点的距离的平方的5倍加1没有最大值，最小值是以原点为圆心的圆与反比例函数的切点。

所以上文中求得的两个点是最小值点

The minimum is 11, attained at both (±1,±1), there is no maximum. 

---



## Question 2: 

Use the method of Lagrange multipliers to find the maximum and minimum of $f(x,y) = x+3y$ subject to the constraint $x^2 +y^2 = 10$



**Solution:** 
$$
\left\{\begin{array}{l}
\nabla f=\lambda \nabla g
g(x,y)=c
\end{array}\right.
\\
\Downarrow
\\
\left\{\begin{array}{l}
1=\lambda 2y
\\
3=\lambda 2x
\\
x^2+y^2=10
\end{array}\right.
\\
\Downarrow
\\
\left\{\begin{array}{l}
x=\frac{1}{2\lambda}
\\
y=\frac{3}{2\lambda}
\\
4\lambda^2=1
\end{array}\right.
$$

解得：
$$
\left\{\begin{array}{l}
x=\pm 1 
\\
y=\pm 3
\\
\lambda=\pm \frac{1}{2}
\end{array}\right.
$$

所以可能的极值点为：

(1,3)(-1,-3)

f(1,3)=10
f(-1,-3)=-10

The minimum is −10, attained at (−1,−3), and the maximum is 10, attained at (1,3). 

---



## Question 3:

Use the method of Lagrange multipliers to find the maximum of f(x1,x2,x3) = 5x1x2x3 subject to the constraint x1 +2x2 +3x3 = 24. 



**Solution:** 
$$
\left\{\begin{array}{l}
\nabla f=\lambda \nabla g
\\
g(x_1,x_2,x_3)=c
\end{array}\right.
\\
\\
\left\{\begin{array}{l}
5x_2x_3=\lambda
\\
5x_2x_3=\lambda
\\
5x_2x_3=\lambda
\\
x_1+2x_2+3x_3=24
\end{array}\right.
$$

所以：

$$
\lambda =5x_2 x_3=\frac{5x_1 x_3}{2}=\frac{5x_1 x_2}{3}
$$
$(-1,2,7), (1,1,7)$ 是符合 $x_1+2x_2+3x_3=24$  的点
且
$$
f(-1,2,7)=-70
\\
f(1,1,7)=35
$$

我们假设 $x_1,x_2,x_3 \neq 0$
因为如果他们中的一个等于零，
$$
f(x_1,x_2,x_3)=0
$$

而-70<0<35
若
$$
x_1,x_2,x_3 \neq 0
$$

则

$$
x_1+2x_2+3x_3=3x_3+3x_3+3x_3=9x_3=24
x_3=\frac{8}{3}
\\
x_1=8
\\
x_2=4
\\
f(8,4,\frac{8}{3})=426.7
$$

但是：
$$
f(-8,-4,\frac{40}{3})=2133.3
$$

所以这个方程无最大值，无最小值

---




## Question 4: 

Use the method of Lagrange multipliers to find the maximum and minimum of $f(w,x,y,z) = w+x+y+z$ subject to the constraint $w^2 +x^2 +y^2 +z^2 = 1$. 



**Solution:**

F is a polynomial so it is continuous and the constraint is closed and bounded so by evt this function has both max and min 

$$
\left\{\begin{array}{l}
\nabla f=\lambda \nabla g
\\
g(w,x,y,z)=c
\end{array}\right.
\\
\\
\left\{\begin{array}{l}
1=\lambda 2w 
\\
1=\lambda 2x 
\\
1=\lambda 2y 
\\
1=\lambda 2z 
\\
w^2+x^2+y^2+z^2=1 
\end{array}\right.
\\
\Downarrow 
\\
w=x=y=z=\frac{1}{2}\lambda
\\
\frac{1}{4}\lambda^2+\frac{1}{4}\lambda^2+\frac{1}{4}\lambda^2+\frac{1}{4}\lambda^2=1
\\
\Downarrow 
\\
\lambda^2=\pm 1
$$

所以我们得到极值点：

$P=\dfrac{1}{2}, \dfrac{1}{2}, \dfrac{1}{2}, \dfrac{1}{2}), Q=(−\dfrac{1}{2},−\dfrac{1}{2},−\dfrac{1}{2},−\dfrac{1}{2})$

$f(P)=2, f(Q)=-2$. 

By evt, The minimum is −2 at $(−\dfrac{1}{2},−\dfrac{1}{2},−\dfrac{1}{2},−\dfrac{1}{2})$, the maximum is 2 at $(\dfrac{1}{2}, \dfrac{1}{2}, \dfrac{1}{2}, \dfrac{1}{2})$. 

---



## Question 5:

Use the method of Lagrange multipliers to find the maximum and minimum of $f(x,y,z) = y$ subject to the constraints $z = x+y$ and $2x_2 +y_2 +2z_2 = 8$. 



**Solution:**
F is a polynomial so it is continuous, the domain is the surface of a sphere so it is closed and bounded, by evt, f attains both max and min.
$$
\begin{gather}
\nabla f =\lambda_1\nabla g_1+\lambda_2\nabla g_2
\\
g_1 =c_1
\\
g_2 =c_2
\\
\Downarrow
\\
0 =-\lambda_1+\lambda_2 4 x \hfill (2) 
\\
1 =-\lambda_1+\lambda_2 2 y \tag{2}
\\
0 =\lambda_1+\lambda_2 4 z
\\
z-x-y =0 \tag{4}
\\
2x^2 + y^2 + 2 z^2 =8
\end{gather}
$$
式子2和4得到：


$$
4\lambda_2 (x+z)=0
\\
-x=z
$$
since 
$$
\lambda_2 \neq 0
$$


because we have 
$$
0=-\lambda_1+\lambda_2 4 x
\\

1=-\lambda_1+\lambda_2 2 y
\\
-1=(4x-2y) \lambda_2 \quad\text{so} \quad \lambda_2\neq 0
$$

So 

$$
-x=z
\\
1=-\lambda_1-\lambda_2 4 x
\\
y=-2 x
\\
2x^2 + 2x^2 + 2x^2 = 8
$$

故：
$$
z=\pm 1
\\
1=-\lambda_1-\lambda_2 4 x
\\
Y=\pm 1
\\
x=\pm 2
$$

so

f(1,-2,-1)=-2
f(-1,2,1)=2


The minimum is −2 at (1,−2,−1), the maximum is 2 at (−1,2,1). 

---



## Question 6:

A company is planning to sell a new product at the price of ¥125 per unit and estimates that if x euro is spent on training staff and y euro is spent on advertising the product, then 50y y +300 + 75x x+200

units of the product will be sold. The cost of manufacturing the product is ¥45 per unit. If the company has a total of ¥5,000 to spend on training staff and advertisement, how should this money be allocated to generate the largest possible profit? 

♣ Note: the profit function is given by (No. of units) × (price per unit- cost per unit)- total amount spent on training and advertisement 



**Solution:**

我们要优化的函数是:
$$
f (x,y)=80×[50y/(y+300)+75x/(x+200)]-x-y
$$

约束为：
$$
x+y \leq 5000  
\\
x,y \geq 0
$$

可行集是一个三角形。为了找到极值点，计算导数
$$
f_x=x^2 + 400x-116000/(x+200)^2=0
\\
f_y=y^2 + 600y-111000/(y+300)^2=0
$$
只有一个极值点： P(x,y)
$$
x=200\sqrt{30}-200
\\
y=200\sqrt{30}-300
$$
在该点处：
$$
f(P)= 6118.22
$$

因为这是唯一的极值点,，且

$$
f(0,0)=0
\\
f(5000,0)=769.23
\\
f(0,5000)=-1226.42
$$

所以 f 在 P 处达到最大值

The maximum profit is of 6118.22€, obtained spending x =895.45€ in training staff, y =795.45€ on advertising. 

---




# PS4：

In each of the following, transform the constraint set of the linear programming problem into the standard form, incorporating all supplemental variables.



### (a)
$$
\begin{aligned}
3x_1 + x_2 &\leq 25 \\
x_1 + 5x_2 &\leq 12 \\
x_1, x_2 &\geq 0
\end{aligned}
\quad \Rightarrow \quad
\begin{cases}
3x_1 + x_2 + s_1 = 25 \\
x_1 + 5x_2 + s_2 = 12 \\
x_1, x_2, s_1, s_2 \geq 0
\end{cases}
\quad \text{( } s_1, s_2 \text{ are slack variables)}
$$



---

### (b)
$$
\begin{aligned}
x_1 &\leq 2 \\
2x_2 &\leq 13 \\
x_1 + x_2 &\geq 3 \\
x_1, x_2 &\geq 0
\end{aligned}
\quad \Rightarrow \quad
\begin{cases}
x_1 + s_1 = 2 \\
2x_2 + s_2 = 13 \\
x_1 + x_2 - e_3 + a_3 = 3 \\
x_1, x_2, s_1, s_2, e_3, a_3 \geq 0
\end{cases}
\quad \text{( } s_1, s_2 \text{ slack; } e_3 \text{ surplus; } a_3 \text{ artificial)}
$$



---

### (c)
$$
\begin{aligned}
x_1 + x_2 &\leq 5 \\
x_1 - x_2 &\geq -2 \\
3x_2 &\leq 8 \\
x_1, x_2 &\geq 0
\end{aligned}
\quad \Rightarrow \quad
\begin{cases}
x_1 + x_2 + s_1 = 5 \\
-x_1 + x_2 + s_2 = 2 \\
3x_2 + s_3 = 8 \\
x_1, x_2, s_1, s_2, s_3 \geq 0
\end{cases}
$$



---

### (d)
$$
\begin{aligned}
3x_1 + 5x_2 + 8x_3 &\leq 100 \\
x_1 - 2x_2 + 5x_3 &\geq -5 \\
-2x_1 + x_2 - 6x_3 &\leq -2 \\
x_1, x_2, x_3 &\geq 0
\end{aligned}
\quad \Rightarrow \quad
\begin{cases}
3x_1 + 5x_2 + 8x_3 + s_1 = 100 \\
-x_1 + 2x_2 - 5x_3 + s_2 = 5 \\
2x_1 - x_2 + 6x_3 - e_3 + a_3 = 2 \\
x_1, x_2, x_3, s_1, s_2, e_3, a_3 \geq 0
\end{cases}
\quad \text{( } s_1, s_2 \text{ slack; } e_3 \text{ surplus; } a_3 \text{ artificial)}
$$



---

### (e)
$$
\begin{aligned}
-3x_1 + 3x_2 - x_3 &\leq 80 \\
x_1 - x_2 + 4x_3 &\geq 30 \\
x_1 + x_2 - x_3 &\geq 20 \\
x_1 \leq 0, \quad x_2, x_3 &\geq 0
\end{aligned}
\quad \Rightarrow \quad
\text{(Substitution: } y_1 = -x_1 \text{)}
\quad \Rightarrow \quad
\begin{cases}
3y_1 + 3x_2 - x_3 + s_1 = 80 \\
-y_1 - x_2 + 4x_3 - e_2 + a_2 = 30 \\
-y_1 + x_2 - x_3 - e_3 + a_3 = 20 \\
y_1, x_2, x_3, s_1, e_2, a_2, e_3, a_3 \geq 0
\end{cases}
$$



---

### (f)
$$
\begin{aligned}
-x_1 + 5x_2 - x_3 &\leq 50 \\
x_1 - x_2 + 6x_3 &\geq 22 \\
x_1, x_3 &\geq 0
\end{aligned}
\quad \Rightarrow \quad
\text{(Substitution: } x_2 = y_2 - w_2 \text{)}
\quad \Rightarrow \quad
\begin{cases}
-x_1 + 5y_2 - 5w_2 - x_3 + s_1 = 50 \\
x_1 - y_2 + w_2 + 6x_3 - e_1 + a_1 = 22 \\
x_1, y_2, w_2, x_3, s_1, e_1, a_1 \geq 0
\end{cases}
$$



---

# PS5：



## Question1:

考虑以下线性规划问题：

最大化 

$$
z = 7x_1 + 4x_2
$$

约束条件：

$$
\begin{align*}
2x_1 + x_2 & \leq 20 \\
x_1 + 2x_2 & \leq 18 \\
x_1, x_2 & \geq 0
\end{align*}
$$

(I) 使用图形法求解上述问题。  

(II) 使用单纯形法求解上述问题。

---

**solution:**

(I) 

![ps5q1](LP图像/ps5q1.png)

(II) 

写出目标函数以及约束的标准形式：
$$
z-7x_1-4x_2=0
\\
2x_1+x_2+s_1=20
\\
x_1+x_2+s_2=18
$$

画出表格：

| $z$  | $x_1$       | $x_2$ | $s_1$ | $s_2$ | $c_i$ | Row Number |
| ---- | ----------- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -7          | -4    | 0     | 0     | 0     | $R_0$      |
| 0    | $\boxed{2}$ | 1     | 1     | 0     | 20    | $R_1$      |
| 0    | 1           | 1     | 0     | 1     | 18    | $R_2$      |


$$
R_1=\frac{1}{2}*R_1 \qquad R_0=R_0+7*R_1 \qquad R_2=R_2-R_1
$$

| $z$  | $x_1$ | $x_2$                 | $s_1$          | $s_2$ | $c_i$           | Row Number |
| ---- | ----- | --------------------- | -------------- | ----- | --------------- | ---------- |
| 1    | 0     | $-\frac{1}{2}$        | $\frac{7}{2}$  | 0     | $-\frac{70}{2}$ | $R_0$      |
| 0    | 1     | $\frac{1}{2}$         | $\frac{1}{2}$  | 0     | 10              | $R_1$      |
| 0    | 0     | $\boxed{\frac{1}{2}}$ | $-\frac{1}{2}$ | 1     | 8               | $R_2$      |

$$
R_0=R_0+R_2 \qquad R_1=R_1-R_2 \qquad R_2=2*R_2
$$

| $z$  | $x_1$ | $x_2$ | $s_1$ | $s_2$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 0     | 0     | 3     | 1     | 78    | $R_0$      |
| 0    | 1     | 0     | 1     | -1    | 2     | $R_1$      |
| 0    | 0     | 1     | 1     | 2     | 16    | $R_2$      |

78，在点 (2, 16)。

---



## Question2:

考虑以下线性规划问题：

最大化 

$$
z = x_1 + 2x_2
$$

约束条件：

$$
\begin{align*}
x_1 & \leq2 \\
x_2 & \leq2 \\
x_1 + x_2 & \leq 3 \\
x_1, x_2 & \geq 0
\end{align*}
$$

(I) 使用图形法求解上述问题。 
(II) 使用单纯形法求解上述问题。

**Solution:**

(I)

![ps5q2](LP图像/ps5q2.png)

(II) 


| $z$  | $x_1$ | $x_2$       | $s_1$ | $s_2$ | $s_3$ | $c_i$ | Row Number |
| ---- | ----- | ----------- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -1    | -2          | 0     | 0     | 0     | 0     | $R_0$      |
| 0    | 1     | 0           | 1     | 0     | 0     | 2     | $R_1$      |
| 0    | 0     | $\boxed{1}$ | 0     | 1     | 0     | 2     | $R_2$      |
| 0    | 1     | 1           | 0     | 0     | 1     | 3     | $R_3$      |


$$
R_0=R_0+2*R_2 \qquad R_3=R_3-R_2
$$

| $z$  | $x_1$       | $x_2$ | $s_1$ | $s_2$ | $s_3$ | $c_i$ | Row Number |
| ---- | ----------- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -1          | 0     | 0     | 2     | 0     | 4     | $R_0$      |
| 0    | 1           | 0     | 1     | 0     | 0     | 2     | $R_1$      |
| 0    | 0           | 1     | 0     | 1     | 0     | 2     | $R_2$      |
| 0    | $\boxed{1}$ | 0     | 0     | -1    | 1     | 1     | $R_3$      |

$$
R_0=R_0+R_3 \qquad R_1=R_1-R_3
$$

| $z$  | $x_1$ | $x_2$ | $s_1$ | $s_2$ | $s_3$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 0     | 0     | 0     | 1     | 1     | 5     | $R_0$      |
| 0    | 0     | 0     | 1     | 1     | -1    | 1     | $R_1$      |
| 0    | 0     | 1     | 0     | 1     | 0     | 2     | $R_2$      |
| 0    | 1     | 0     | 0     | 1     | 1     | 1     | $R_3$      |

---



##  Question3：

使用单纯形法求解以下线性规划问题：

最大化 

$$
P = 3x + y + 4z
$$

约束条件：

$$
\begin{align*}
3x + 5y + 10z & \leq 120 \\
5x + 5y + 2z & \leq 6 \\
-8x-3y-10z & \geq -105 \\
x, y, z & \geq 0
\end{align*}
$$

---

**Solution:**  

| $P$  | $x$  | $y$  | $z$         | $s_1$ | $s_2$ | $s_3$ | $c_i$ | Row Number |
| ---- | ---- | ---- | ----------- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -3   | -1   | -4          | 0     | 0     | 0     | 0     | $R_0$      |
| 0    | 3    | 5    | 10          | 1     | 0     | 0     | 120   | $R_1$      |
| 0    | 5    | 5    | $\boxed{2}$ | 0     | 1     | 0     | 6     | $R_2$      |
| 0    | 8    | 3    | 10          | 0     | 0     | 1     | 105   | $R_3$      |

$$
R_1=R_1/2 \quad R_0=R_0 + 6 * R_1 \quad R_2=R_2 - 1 * R_1 \quad R_3=R_3 - 2 * R_1
$$


| $P$  | $x$  | $y$  | $z$  | $s_1$ | $s_2$ | $s_3$ | $c_i$ | Row Number |
| ---- | ---- | ---- | ---- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 7    | 9    | 0    | 0     | 2     | 0     | 12    | $R_0$      |
| 0    | -22  | -20  | 0    | 1     | -5    | 0     | 90    | $R_1$      |
| 0    | 25   | 25   | 1    | 0     | 0.5   | 0     | 3     | $R_2$      |
| 0    | -17  | -22  | 0    | 0     | -5    | 1     | 75    | $R_3$      |

12，在点 (0, 0, 3)。

---



## Question 4：

使用单纯形法求解以下线性规划问题：

最大化 

$$
z = 5x_1 + 6x_2 + 4x_3
$$

约束条件：

$$
\begin{align*}
x_1 + 2x_2 + 3x_3 & \leq 180 \\
3x_1 + x_2 + 2x_3 & \leq 300 \\
x_1 + 2x_2 + 2x_3 & \leq 240 \\
x_1, x_2, x_3 & \geq 0
\end{align*}
$$

标准形式：
$$
\begin{align*}
z - 5x_1 - 6x_2 - 4x_3& = 0\\
x_1 + 2x_2 + 3x_3 +s_1& = 180 \\
3x_1 + x_2 + 2x_3 +s_2& = 300 \\
x_1 + 2x_2 + 2x_3 +s_3& = 240 \\
\end{align*}
$$

| $z$ | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $s_2$ | $s_3$ | $c_i$ | Row      |
| ----- | -------- | -------- | -------- | -------- | -------- | -------- | --- | -------- |
| 1     | -5       | -6       | -4       | 0        | 0        | 0        | 0   | $R_0$ |
| 0     | 1        | $\boxed{2}$ | 3        | 1        | 0        | 0        | 180 | $R_1$ |
| 0     | 3        | 1        | 2        | 0        | 1        | 0        | 300 | $R_2$ |
| 0     | 1        | 2        | 2        | 0        | 0        | 1        | 240 | $R_3$ |

$$
R_1=R_1/2 \quad R_0=R_0 + 6 * R_1 \quad R_2=R_2 - 1 * R_1 \quad R_3=R_3 - 2 * R_1
$$

| $z$ | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $s_2$ | $s_3$ | $c_i$ | Row      |
| ----- | -------- | -------- | -------- | -------- | -------- | -------- | --- | -------- |
| 1     | -2       | 0        | 5        | 3        | 0        | 0        | 540 | $R_0$ |
| 0     | 0.5      | 1        | 1.5      | 0.5      | 0        | 0        | 90  | $R_1$ |
| 0     | $\boxed{2.5}$ | 0        | 0.5      | 0.5      | 1        | 0        | 210 | $R_2$ |
| 0     | 0        | 0        | -1       | -1       | 0        | 1        | 60  | $R_3$ |

$$
R_2=R_2/2.5 \quad R_0=R_0 + 2 * R_2 \quad R_1=R_1 - 0.5 * R_2
$$

| $z$ | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $s_2$ | $s_3$ | $c_i$ | Row      |
| ----- | -------- | -------- | -------- | -------- | -------- | -------- | --- | -------- |
| 1     | 0        | 0        | 5.4      | 3.4      | 0        | 0        | 708 | $R_0$ |
| 0     | 0        | 1        | 1.4      | 0.4      | 0        | 0        | 48  | $R_1$ |
| 0     | 1        | 0        | 0.2      | 0.2      | 0.4      | 0        | 84  | $R_2$ |
| 0     | 0        | 0        | -1       | -1       | 0        | 1        | 60  | $R_3$ |

$z=708, x_3=s_1=0$

$x_2=78$

$x_1 s_2$无法确定

$s_3=60$

---



## Question 5：

使用单纯形法求解以下线性规划问题：

最大化 

$$
z = 5x_1 + 4x_2 - 6x_3
$$

约束条件：

$$
\begin{align*}
4x_1 + x_2 - x_3 & \leq 19 \\
3x_1 + 4x_2 - 6x_3 & \leq 30 \\
2x_1 + 4x_2 - x_3 & \leq 25 \\
x_1 + x_2 - 2x_3 & \leq 15 \\
x_1, x_2  \geq 0, \quad x_3 &\leq 0
\end{align*}
$$

令 $y_3=-x_3$，这样一来，$y_3\geq 0$

标准形式：
$$
z-5x_1 - 4x_2 - 6y_3=0 \\
4x_1 + x_2 + y_3 + s_1=19 \\
3x_1 + 4x_2 + 6y_3 +s_2= 30 \\
2x_1 + 4x_2  +y_3 + s_3= 25 \\
x_1 + x_2 + 2y_3 +s_4= 15 \\
$$

| $z$ | $x_1$ | $x_2$ | $y_3$ | $s_1$ | $s_2$ | $s_3$ | $s_4$ | RHS | Row      |
| ----- | -------- | -------- | -------- | -------- | -------- | -------- | -------- | --- | -------- |
| 1     | -5       | -4       | -6       | 0        | 0        | 0        | 0        | 0   | $R_0$ |
| 0     | 4        | 1        | 1        | 1        | 0        | 0        | 0        | 19  | $R_1$ |
| 0     | 3        | 4        | $\boxed{6}$ | 0        | 1        | 0        | 0        | 30  | $R_2$ |
| 0     | 2        | 4        | 1        | 0        | 0        | 1        | 0        | 25  | $R_3$ |
| 0     | 1        | 1        | 2        | 0        | 0        | 0        | 1        | 15  | $R_4$ |

$$
R_2=\frac{1}{6}*R_2 \qquad R_0=R_0+6*R_2 \qquad R_1=R_1-R_2 \qquad R_3=R_3-R_2 \qquad R_4=R_4-2*R_2
$$

| $z$ | $x_1$      | $x_2$       | $y_3$ | $s_1$ | $s_2$ | $s_3$ | $s_4$ | RHS | Row      |
| ----- | ------------- | -------------- | -------- | -------- | -------- | -------- | -------- | --- | -------- |
| 1     | -2            | 0              | 0        | 0        | 1        | 0        | 0        | 30  | $R_0$ |
| 0     | $\boxed{3.5}$ | 1/3  | 0        | 1        | -1/6     | 0        | 0        | 14  | $R_1$ |
| 0     | 0.5           | 2/3            | 1        | 0        | 1/6      | 0        | 0        | 5   | $R_2$ |
| 0     | 1.5 | 10/3 | 0        | 0        | -1/6     | 1        | 0        | 20  | $R_3$ |
| 0     | 0     | -1/3 | 0        | 0        | -1/3     | 0        | 1        | 5   | $R_4$ |

$$
R_1=\frac{2}{7}*R_1 \qquad R_0=R_0+2*R_1 \qquad R_2=R_2-0.5*R_1 \qquad R_3=R_3-1,5*R_1
$$

| z | x₁ | x₂    | y₃ | s₁   | s₂    | s₃ | s₄ | RHS | Row |
| - | -- | ----- | -- | ---- | ----- | -- | -- | --- | --- |
| 1 | 0  | 1/5   | 0  | 4/7  | 19/21 | 0  | 0  | 38  | R₀  |
| 0 | 1  | 2/21  | 0  | 2/7  | -1/21 | 0  | 0  | 4   | R₁  |
| 0 | 0  | 13/21 | 1  | -1/7 | 3/14  | 0  | 0  | 3   | R₂  |
| 0 | 0  | 20/7  | 0  | -3/7 | -2/21 | 1  | 0  | 14  | R₃  |
| 0 | 0  | -1/3  | 0  | -2/7 | -1/3  | 0  | 1  | 5   | R₄  |

---



# PS6：



## Question 1:

Solve the following LP problem by the simplex method:

Minimize  
$$
z = 3x_1 - 2x_2
$$

$$
\begin{align*} 
x_1 - x_2 & \leq 1 \\
x_1 - x_2 & \leq -2 \\
x_1, x_2 & \geq 0 
\end{align*}
$$

最大化
$$
z = - 3x_1 + 2x_2
$$

标准形式：
$$
z + 3x_1 - 2x_2 = 0 \\
x_1-x_2+s_1=1 \\
-x_1 + x_2 +s_2 = 2 \\
x_1,x_2,s_1,s_2 \geq 0
$$

初始表格:

| $z$  | $x_1$ | $x_2$ | $s_1$ | $s_2$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 3     | -2    | 0     | 0     | 0     | $R_0$      |
| 0    | 1     | -1    | 1     | 0     | 1     | $R_1$      |
| 0    | -1    | 1     | 0     | 1     | 2     | $R_2$      |

$R_0$有负数项，进行行运算。


$$
R_0=R_0+2*R_2 \quad R_1=R_1+R_2
$$

| $z$  | $x_1$ | $x_2$ | $s_1$ | $s_2$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 1     | 0     | 0     | 2     | 4     | $R_0$      |
| 0    | 0     | 0     | 1     | 1     | 3     | $R_1$      |
| 0    | -1    | 1     | 0     | 1     | 2     | $R_2$      |

新表中$R_0$没有负数项

---



## Question 2:

Solve the following LP problem by the simplex method:

Maximize 
$$
z = 8x_1 + 2x_2 + 2x_3
$$

subject to

$$
\begin{align*} 
2x_1 + x_2 + 4x_3 & \leq 60 \\
-x_2 - x_3 & \leq -40 \\
x_1, x_2, x_3 & \geq 0
\end{align*}
$$

**Solution:**

约束右侧必须非负：
$$
-x_2 - x_3  \leq -40  \quad \rightarrow x_2 + x_3  \geq 40
$$

存在 $\geq$ 约束的问题。目标函数要减去M
$$
z = 8x_1 + 2x_2 + 2x_3 \quad \rightarrow z = 8x_1 + 2x_2 + 2x_3 - M a_2
$$

标准形式：
$$
z - 8x_1 - 2x_2 - 2x_3 + M = 0 \\
2x_1 + x_2 + 4x_3 + s_1 = 60 \\
x_2 + x_3 - e_2 + a_2 = 40 \\
x_1, x_2, x_3, e_2, a_2  \geq 0
$$

| $z$  | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $e_2$ | $a_2$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -8    | -2    | -2    | 0     | 0     | M     | 0     | $R_0$      |
| 0    | 2     | 1     | 4     | 1     | 0     | 0     | 60    | $R_1$      |
| 0    | 0     | 1     | 1     | 0     | -1    | 1     | 40    | $R_2$      |

$$
R_0=-M*R_2+R_0
$$

| $z$  | $x_1$ | $x_2$       | $x_3$ | $s_1$ | $e_2$ | $a_2$ | $c_i$ | Row Number |
| ---- | ----- | ----------- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -8    | -2-M        | -2-M  | 0     | M     | 0     | -40M  | $R_0$      |
| 0    | 2     | 1           | 4     | 1     | 0     | 0     | 60    | $R_1$      |
| 0    | 0     | $\boxed{1}$ | 1     | 0     | -1    | 1     | 40    | $R_2$      |

$$
R_0=(2+M)*R_2+R_0 \quad R_1=-R_2+R_1
$$

| $z$  | $x_1$       | $x_2$ | $x_3$ | $s_1$ | $e_2$ | $a_2$ | $c_i$ | Row Number |
| ---- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -8          | 0     | 0     | 0     | -2    | 2+M   | 80    | $R_0$      |
| 0    | $\boxed{2}$ | 0     | 3     | 1     | 1     | -1    | 20    | $R_1$      |
| 0    | 0           | 1     | 1     | 0     | -1    | 1     | 40    | $R_2$      |

$$
R_1=\frac{1}{2}R_1 \quad R_0=8*R_1+R_0
$$

| $z$  | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $e_2$ | $a_2$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 0     | 0     | 6     | 4     | 2     | M-2   | 160   | $R_0$      |
| 0    | 1     | 0     | 1.5   | 0.5   | 0.5   | -0.5  | 10    | $R_1$      |
| 0    | 0     | 1     | 1     | 0     | -1    | 1     | 40    | $R_2$      |

---



## Question 3:

Solve the following LP problem by the simplex method:

Minimize 

$$
z = 2x_1 - 3x_2 + x_3
$$

subject to 
$$
\begin{align*} 
2x_1 - x_2 + 3x_3 & \leq 7 \\
-4x_2 + 2x_3 & \geq 12 \\
8x_1 + 3x_2 - 4x_3 & \leq 10 \\
x_1, x_2, x_3 & \geq 0
\end{align*}
$$

### Solution:

目标函数减去M：
$$
z = -2x_1 + 3x_2 - x_3 - M a_2
$$

标准形式：
$$
z + 2x_1 - 3x_2 + x_3 + M a_2 = 0 \\
2x_1 - x_2 + 3x_3 + s_1 = 7 \\
-4x_2 + 2x_3 - e_2 + a_2 = 12 \\
8x_1 + 3x_2 - 4x_3 + s_3 = 10 \\
x_1, x_2, x_3, s_1, e_2, a_2, s_3 \geq 0
$$

| $z$  | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $e_2$ | $a_2$ | $s_3$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 2     | -3    | 1     | 0     | 0     | M     | 0     | 0     | $R₀$       |
| 0    | 2     | -1    | 3     | 1     | 0     | 0     | 0     | 7     | $R_1$      |
| 0    | 0     | -4    | 2     | 0     | -1    | 1     | 0     | 12    | $R_2$      |
| 0    | 8     | 3     | -4    | 0     | 0     | 0     | 1     | 10    | $R_3$      |

$$
R_0=-M*R_2 + R_0
$$

| $z$  | $x_1$ | $x_2$ | $x_3$       | $s_1$ | $e_2$ | $a_2$ | $s_3$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----------- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 2     | -3+4M | 1-2M        | 0     | M     | 0     | 0     | -12M  | $R₀$       |
| 0    | 2     | -1    | $\boxed{3}$ | 1     | 0     | 0     | 0     | 7     | $R_1$      |
| 0    | 0     | -4    | 2           | 0     | -1    | 1     | 0     | 12    | $R_2$      |
| 0    | 8     | 3     | -4          | 0     | 0     | 0     | 1     | 10    | $R_3$      |

$$
R_1=\frac{1}{3}R_1 \quad R_0=(-1+2M)R_1+R_0 \quad R_2=-2*R_1+R_2 \quad R_3=4*R_1+R_3
$$

| $z$  | $x_1$                      | $x_2$                       | $x_3$ | $s_1$                      | $e_2$ | $a_2$ | $s_3$ | $c_i$                        | Row Number |
| ---- | -------------------------- | --------------------------- | ----- | -------------------------- | ----- | ----- | ----- | ---------------------------- | ---------- |
| 1    | $\frac{4}{3}M+\frac{4}{3}$ | $\frac{10}{3}M-\frac{8}{3}$ | 0     | $\frac{2}{3}M-\frac{1}{3}$ | M     | 0     | 0     | $-\frac{22}{3}M-\frac{7}{3}$ | $R₀$       |
| 0    | $\frac{2}{3}$              | $-\frac{1}{3}$              | 1     | $\frac{1}{3}$              | 0     | 0     | 0     | $\frac{7}{3}$                | $R_1$      |
| 0    | $-\frac{4}{3}$             | $-\frac{10}{3}$             | 0     | $-\frac{2}{3}$             | -1    | 1     | 0     | $\frac{22}{3}$               | $R_2$      |
| 0    | $\frac{32}{3}$             | $\frac{5}{3}$               | 0     | $\frac{4}{3}$              | 0     | 0     | 1     | $\frac{58}{3}$               | $R_3$      |

---



## Question 4:

Solve the following LP problem by the simplex method:

Maximize 
$$
z = 2x_1 - 3x_2
$$

subject to 

$$
\begin{align*}
x_1 + x_2 \leq 10 \\
x_1 - x_2 \leq 12 \\
2x_1 - x_2 \geq 6 \\
x_1 \geq 0
\end{align*}
$$

### Solution:

令：


$$
x_2=y_2-w_2
$$

$$
z = 2x_1 - 3y_2 + 3w_2 -Ma_3 \\
x_1 + y_2 - w_2 + s_1 = 10 \\
x_1 - y_2 + w_2 + s_2 = 12 \\
2x_1 - y_2 + w_2 - e_3 + a_3 = 6 \\
x_1, y_2, w_2, s_1, s_2, e_3, a_3 \geq 0
$$

| $z$  | $x_1$ | $y_2$ | $w_2$ | $s_1$ | $s_2$ | $e_3$ | $a_3$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -2    | 3     | -3    | 0     | 0     | 0     | M     | 0     | $R₀$       |
| 0    | 1     | 1     | -1    | 1     | 0     | 0     | 0     | 10    | $R_1$      |
| 0    | 1     | -1    | 1     | 0     | 1     | 0     | 0     | 12    | $R_2$      |
| 0    | 2     | -1    | 1     | 0     | 0     | -1    | 1     | 6     | $R_3$      |

$$
R_0=-M*R_3+R_0
$$

| $z$  | $x_1$       | $y_2$ | $w_2$ | $s_1$ | $s_2$ | $e_3$ | $a_3$ | $c_i$ | Row Number |
| ---- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -2-2M       | 3+M   | -3-M  | 0     | 0     | M     | 0     | -6M   | $R₀$       |
| 0    | 1           | 1     | -1    | 1     | 0     | 0     | 0     | 10    | $R_1$      |
| 0    | 1           | -1    | 1     | 0     | 1     | 0     | 0     | 12    | $R_2$      |
| 0    | $\boxed{2}$ | -1    | 1     | 0     | 0     | -1    | 1     | 6     | $R_3$      |

$$
R_3=\frac{1}{2}*R_3 \quad R_0=(2+2M)*R_3+R_0 \quad R_1=-R_3+R_1 \quad R_2=-R_2+R_3
$$

| $z$  | $x_1$ | $y_2$ | $w_2$         | $s_1$ | $s_2$ | $e_3$ | $a_3$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ------------- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 0     | 2     | -2            | 0     | 0     | -1    | 1+M   | 6     | $R₀$       |
| 0    | 0     | 1.5   | -1.5          | 1     | 0     | 0.5   | -0.5  | 7     | $R_1$      |
| 0    | 0     | -0.5  | 0.5           | 0     | 1     | 0.5   | -0.5  | 9     | $R_2$      |
| 0    | 1     | -0.5  | $\boxed{0.5}$ | 0     | 0     | -0.5  | 0.5   | 3     | $R_3$      |

$$
R_3=2*R_3 \quad R_0=2*R_3+R_0 \quad R_1=1.5*R_3+R_1 \quad R_2=-0.5*R_3+R_2
$$

| $z$  | $x_1$ | $y_2$ | $w_2$ | $s_1$ | $s_2$ | $e_3$       | $a_3$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----------- | ----- | ----- | ---------- |
| 1    | 4     | 0     | 0     | 0     | 0     | -3          | 3+M   | 18    | $R₀$       |
| 0    | 3     | 0     | 0     | 1     | 0     | -1          | 1     | 16    | $R_1$      |
| 0    | -1    | 0     | 0     | 0     | 1     | $\boxed{1}$ | -1    | 6     | $R_2$      |
| 0    | 2     | -1    | 1     | 0     | 0     | -1          | 1     | 6     | $R_3$      |


$$
R_0=3*R_2+R_0 \quad R_1=R_2+R_1 \quad R_3=R_2+R_3
$$


| $z$  | $x_1$ | $y_2$ | $w_2$ | $s_1$ | $s_2$ | $e_3$ | $a_3$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 1     | 0     | 0     | 0     | 3     | 0     | M     | 36    | $R₀$       |
| 0    | 2     | 0     | 0     | 1     | 1     | 0     | 0     | 22    | $R_1$      |
| 0    | -1    | 0     | 0     | 0     | 1     | 1     | -1    | 6     | $R_2$      |
| 0    | 1     | -1    | 1     | 0     | 1     | 0     | 1     | 12    | $R_3$      |

---



## Question 5:

Solve the following LP problem by the simplex method:

Minimize
$$
z = 2x_1 + 3x_2
$$

subject to
$$
\begin{align*}
-x_1 + x_2 &\leq 10 \\
-x_1 - x_2 &\leq 12 \\
-2x_1 - x_2 &\geq 6 \\
x_1 \geq 0, x_2 &\leq 0
\end{align*}
$$

maximize: $z=-2x_1-3x_2$

---



## Question 6:

Solve the following LP problem by the simplex method:

Minimize
$$
z = x_1 + x_2
$$

subject to
$$
\begin{align*}
2x_1 + x_2 &\geq 16 \\
x_1 + 2x_2 &\geq 20 \\
x_1, x_2 &\geq 0
\end{align*}
$$

| $z$  | $x_1$ | $x_2$ | $e_1$ | $a_1$ | $e_2$ | $a_2$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 1     | 1     | 0     | M     | 0     | M     | 0     | $R_0$      |
| 0    | 2     | 1     | -1    | 1     | 0     | 0     | 16    | $R_1$      |
| 0    | 1     | 2     | 0     | 0     | -1    | 1     | 20    | $R_2$      |

$$
R_0=-MR_1+R_0 \qquad R_0=-MR_2+R_0
$$

| $z$  | $x_1$       | $x_2$ | $e_1$ | $a_1$ | $e_2$ | $a_2$ | $c_i$ | Row Number |
| ---- | ----------- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 1-3M        | 1-3M  | M     | 0     | M     | 0     | -36M  | $R_0$      |
| 0    | $\boxed{2}$ | 1     | -1    | 1     | 0     | 0     | 16    | $R_1$      |
| 0    | 1           | 2     | 0     | 0     | -1    | 1     | 20    | $R_2$      |

$$
R_1=\frac{1}{2}R_1 \qquad R_0=(3M-1)R_1+R_0 \qquad R_2=R_2-R_1
$$

| $z$  | $x_1$ | $x_2$         | $e_1$    | $a_1$    | $e_2$ | $a_2$ | $c_i$  | Row Number |
| ---- | ----- | ------------- | -------- | -------- | ----- | ----- | ------ | ---------- |
| 1    | 0     | 0.5-1.5M      | 0.5+0.5M | 1.5M-0.5 | M     | 0     | -12M-8 | $R_0$      |
| 0    | 1     | 0.5           | -0.5     | 0.5      | 0     | 0     | 8      | $R_1$      |
| 0    | 0     | $\boxed{1.5}$ | 0.5      | -0.5     | -1    | 1     | 20     | $R_2$      |

$$
R_2=\frac{2}{3}R_2 \qquad R_1=-\frac{1}{2}R_2+R_1 \qquad R_0=(-0.5+1.5M)R_2+R_0
$$

| $z$  | $x_1$ | $x_2$ | $e_1$         | $a_1$          | $e_2$          | $a_2$         | $c_i$          | Row Number |
| ---- | ----- | ----- | ------------- | -------------- | -------------- | ------------- | -------------- | ---------- |
| 1    | 0     | 0     | 1             | -0.25 + 0.75M  | 0              | 1.0           | $-8$           | $R_0$      |
| 0    | 1     | 0     | -0.75         | 0.75           | 0.5            | -0.5          | $-4$           | $R_1$      |
| 0    | 0     | 1     | $\frac{1}{3}$ | $-\frac{1}{3}$ | $-\frac{2}{3}$ | $\frac{2}{3}$ | $\frac{40}{3}$ | $R_2$      |

---



# PS7

---

Formulate the dual problem of the LP problem:



## Question 1

### Primal Problem

**Maximize**
$$
z = -3x_1 + 2x_2
$$

**Subject to**
$$
\begin{aligned}
x_1 - x_2 &\leq 3 \\
-x_1 + x_2 &\leq 6 \\
x_1, x_2 &\geq 0
\end{aligned}
$$

### Dual Problem

**Minimize**
$$
z = 3y_1 + 6y_2
$$

**Subject to**
$$
\begin{aligned}
y_1 - y_2 &\geq -3 \\
-y_1 + y_2 &\geq 2 \\
y_1, y_2 &\geq 0
\end{aligned}
$$

---



## Question 2

### Primal Problem

**Maximize**
$$
z = 8x_1 + 2x_2 - 2x_3
$$

**Subject to**
$$
\begin{aligned}
2x_1 - x_2 + 4x_3 &\leq 60 \\
x_2 - x_3 &\leq 40 \\
x_1, x_2, x_3 &\geq 0
\end{aligned}
$$

### Dual Problem

**Minimize**
$$
z = 60y_1 + 40y_2
$$

**Subject to**
$$
\begin{aligned}
2y_1 &\geq 8 \\
-y_1 + y_2 &\geq 2 \\
4y_1 - y_2 &\geq -2 \\
y_1, y_2 &\geq 0
\end{aligned}
$$

---



## Question 3

### Primal Problem

**Maximize**
$$
z = 3x_1 - x_2 + 8x_3
$$

**Subject to**
$$
\begin{aligned}
x_1 + 2x_2 - x_3 &\leq 28 \\
x_1 - 2x_2 &\leq 16 \\
x_1, x_2, x_3 &\geq 0
\end{aligned}
$$

### Dual Problem

**Minimize**
$$
w = 28y_1 + 16y_2
$$

**Subject to**
$$
\begin{aligned}
y_1 + y_2 &\geq 3 \\
2y_1 - 2y_2 &\geq -1 \\
-y_1 &\geq 8 \\
y_1, y_2 &\geq 0
\end{aligned}
$$

---



## Question 4

### Primal Problem

**Maximize**
$$
z = 2x_1 + 3x_2 - x_3 + 3x_4
$$

**Subject to**
$$
\begin{aligned}
-x_1 + x_2 + 2x_3 &\leq 21 \\
2x_1 - x_2 + 4x_4 &\leq 25 \\
3x_1 + 8x_2 - x_4 &\leq 36 \\
x_1, x_2, x_3, x_4 &\geq 0
\end{aligned}
$$

### Dual Problem

**Minimize**
$$
z = 21y_1 + 25y_2 + 36y_3
$$

**Subject to**
$$
\begin{aligned}
-y_1 + 2y_2 + 3y_3 &\geq 2 \\
y_1 - y_2 + 8y_3 &\geq 3 \\
2y_1 &\geq -1 \\
6y_2 - y_3 &\geq 3 \\
y_1, y_2, y_3 &\geq 0
\end{aligned}
$$

---



# PS8：



## Question 1:

Consider the following LP problem:

Maximize
$$
z = 5x_1 + 3x_2
$$

subject to
$$
\begin{align*}
2x_1 + 4x_2 &\leq 32 \\
3x_1 + 2x_2 &\leq 24 \\
x_1, x_2 &\geq 0
\end{align*}
$$

(I) Solve the original problem with the simplex method.

(II) Formulate the dual problem.

(III) Determine the optimal solution to the dual problem from the optimal tableau of the original problem.

(IV) Solve the dual problem with the simplex method (without using the original LP problem), to verify the previous result.



### Solution:

(I)标准形式：
$$
z=5x_1+3x_2 \\
2x_1+4x_2+s_1 &= 32 \\
3x_1+2x_2+s_2 &= 24 \\
x_1, x_2, s_1, s_2 &\geq 0 \\
$$

| $z$  | $x_1$       | $x_2$ | $s_1$ | $s_2$ | $c_i$ | Row Number |
| ---- | ----------- | ----- | ----- | ----- | ----- | ---------- |
| 1    | -5          | -3    | 0     | 0     | 0     | $R_0$      |
| 0    | 2           | 4     | 1     | 0     | 32    | $R_1$      |
| 0    | $\boxed{3}$ | 2     | 0     | 1     | 24    | $R_2$      |

$$
R_2=\frac{1}{3}R_2 \qquad R_0=5R_2+R_0 \qquad R_1=-2R_2+R_1
$$

| $z$  | $x_1$ | $x_2$           | $s_1$ | $s_2$           | $c_i$ | Row Number |
| ---- | ----- | --------------- | ----- | --------------- | ----- | ---------- |
| 1    | 0     | $\dfrac{1}{3}$  | 0     | $\dfrac{5}{3}$  | 40    | $R_0$      |
| 0    | 1     | $\dfrac{10}{3}$ | 1     | $-\dfrac{1}{3}$ | 24    | $R_1$      |
| 0    | 1     | $\dfrac{2}{3}$  | 0     | $\dfrac{1}{3}$  | 8     | $R_2$      |

 Final table row zero: (1, 0, 1/3, 0, 5/3, 40). 

Setting $s_2 = 0,x_2 = 0$ we find that the maximum of 40 is attained at $x_1 = 8, x_2 = 0$ (reading the rest of the table)

---



(II)

Minimize
$$
z = 32y_1 + 24y_2
$$

subject to
$$
\begin{align*}
2y_1 + 3y_2 &\geq 5 \\
4y_1 + 2y_2 &\geq 3 \\
y_1, y_2 &\geq 0
\end{align*}
$$

---



(III)$32y_1 + 24y_2$ 的最小值是40，即原问题中的最大值是40.
$y_1=R_0中s_1的系数=0$，$y_2=R_0中s_2的系数=5/3$
故：这个最小值在(0,5/3)处取得。

---



(IV)(我不会算)标准形式：
$$
z = - 32y_1 - 24y_2 - Ma_1 - Ma_2 \\
2y_1 + 3y_2 -e_1 + a_1= 5 \\
4y_1 + 2y_2 -e_2 + a_2=3 \\
y_1, y_2, e_1, a_1, e_2, a_2 \geq 0
$$

| $z$  | $y_1$ | $y_2$ | $e_1$ | $a_1$ | $e_2$ | $a_2$ | $c_i$ | Row Number |
| ---- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 32    | 24    | 0     | M     | 0     | M     | 0     | $R_0$      |
| 0    | 2     | 3     | -1    | 1     | 0     | 0     | 5     | $R_1$      |
| 0    | 4     | 2     | 0     | 0     | -1    | 1     | 3     | $R_2$      |

$$
R_0=-MR_1+R_0 \qquad R_0=-MR_2+R_0
$$

| $z$  | $y_1$     | $y_2$ | $e_1$ | $a_1$ | $e_2$ | $a_2$ | $c_i$ | Row Number |
| ---- | --------- | ----- | ----- | ----- | ----- | ----- | ----- | ---------- |
| 1    | 32-6M     | 24-5M | M     | 0     | M     | 0     | -8M   | $R_0$      |
| 0    | 2         | 3     | -1    | 1     | 0     | 0     | 5     | $R_1$      |
| 0    | $\boxed4$ | 2     | 0     | 0     | -1    | 1     | 3     | $R_2$      |

$$
R_2=\frac{1}{4}R_2 \qquad R_1 = R_1 - 2 *R_2 \qquad R_0 = R_0 - (32 - 6M) * R_2
$$

| $z$  | $y_1$ | $y_2$         | $e_1$ | $a_1$ | $e_2$  | $a_2$  | $c_i$    | Row Number |
| ---- | ----- | ------------- | ----- | ----- | ------ | ------ | -------- | ---------- |
| 1    | 0     | 8-2M          | M     | 0     | 8-0.5M | 1.5M-8 | -24-3.5M | $R_0$      |
| 0    | 0     | 2             | -1    | 1     | 0.5    | -0.5   | 3.5      | $R_1$      |
| 0    | 1     | $\boxed{0.5}$ | 0     | 0     | -0.25  | 0.25   | 0.75     | $R_2$      |

$$
R_2=2R_2 \qquad R_1=R_1-2R_2 \qquad R_0=R_0-(8-2M)R_2
$$

| $z$  | $y_1$ | $y_2$ | $e_1$ | $a_1$ | $e_2$         | $a_2$   | $c_i$    | Row Number |
| ---- | ----- | ----- | ----- | ----- | ------------- | ------- | -------- | ---------- |
| 1    | 0     | 0     | M     | 0     | 12-1.5M       | 4.5M-20 | -36-0.5M | $R_0$      |
| 0    | -4    | 0     | -1    | 1     | $\boxed{1.5}$ | -1.5    | 0.5      | $R_1$      |
| 0    | 2     | 1     | 0     | 0     | -0.5          | 0.5     | 1.5      | $R_2$      |

$$
R_1=\dfrac{2}{3}R_1 \qquad R_2=R_2+\dfrac{1}{2}R_1 \qquad R_0=R_0-(12-1.5M)R_1
$$

| $z$  | $y_1$           | $y_2$ | $e_1$           | $a_1$          | $e_2$ | $a_2$ | $c_i$           | Row Number |
| ---- | --------------- | ----- | --------------- | -------------- | ----- | ----- | --------------- | ---------- |
| 1    | 0               | 0     | 8               | 0              | 8-M   | 12-4M | -40             | $R_0$      |
| 0    | $-\dfrac{8}{3}$ | 0     | $-\dfrac{2}{3}$ | $\dfrac{2}{3}$ | 1     | -1    | $\dfrac{1}{3}$  | $R_1$      |
| 0    | 0               | 1     | $-\dfrac{1}{3}$ | $\dfrac{1}{3}$ | 0     | 0     | $\dfrac{11}{6}$ | $R_2$      |


---



## Question 2:

Consider the following LP problem:

Maximize
$$
z = 9x + 12y
$$

subject to
$$
\begin{align*}
2x + 4y &\leq 32 \\
2x + 2y &\leq 20 \\
15x + 8y &\leq 120 \\
x &\leq 7 \\
y &\leq 7 \\
x, y &\geq 0
\end{align*}
$$



(I) Formulate the dual problem.

minimize：
$$
z=32y_1 + 20y_2 + 120y_3 + 7y_4 + 7y_5
$$

subject to
$$
2y_1 + 2y_2 + 15y_3 + y_4 \geq 9 \\

4y_1 + 2y_2 + 8y_3 + y_5 \geq 12 \\

y_1 , y_2 , y_3 , y_4 , y_5 \geq 0
$$

---



(II) Find the optimal value of objective function in the dual LP problem by solving the give LP problem using the graphical method.

---



## Question 3:

Determine if the following statements are True or False, and briefly justify your answer:





(1) The set $[1, 2)$ is open.
错

$B(1,\epsilon)=(1-\epsilon,1+\epsilon)$  will always contain  a point outside of $ [1,2)$ 

for example:  $1-\frac{\epsilon}{2} \notin [1,2)$


---



(2) The set $[1, 2]$ is closed.

错

因为它的补集不开

补集是$(-\infty,1)\cap(2,\infty)$ 

$B(2,\epsilon)=(2-\epsilon,2+\epsilon)$  will always contain  a point outside of $ (-\infty,1)\cap(2,\infty)$

for example:  $2-\frac{\epsilon}{2} \notin (\infty,1)\cap(2,\infty)$ 

so $(-\infty,1)\cap(2,\infty)$ is not open


---



(3) The set $(1, 2]$ is open.

错

$B(2,\epsilon)=(2-\epsilon,2+\epsilon)$  will always contain  a point outside of $ (1,2] $

for example: $2+\frac{\epsilon}{2} \notin (1,2]$ 

so $(1,2]$ is not open


---



(4) The set $[1, 2)$ is closed.

错

因为它的补集不开

补集是
$(-\infty,1]\cap(2,\infty)$

$B(2,\epsilon)=(2-\epsilon,2+\epsilon)$ will always contain  a point outside of $ (-\infty,1]\cap(2,\infty)$ 

for example: $ 1+\frac{\epsilon}{2} \notin (-\infty,1]\cap(2,\infty)$ 

so $(-\infty,1]\cap(2,\infty)$ is not open


---



(5) The set $(0, +\infty)$ is neither closed nor open.

错

它是开的

$\forall x \in(0,\infty), B(x,x)=(x-x,x+x)=(0,2x) \subset (0,\infty)$

所以，$(0,\infty)$是开的


---



(6) The set $\{2n - 1 \mid n \in \mathbb{N}\} \subset \mathbb{R}$ is closed.

正确
we will check its complement $S^c$.  $S^c$ is union of open sets, so it is open. let's explain these open sets.

if $x<1$, 

$B(x,1-x)=(2x-1,1) \subset (-\infty,1) \subset S^c$

if $2n-1<x<2n+1$, 

then take $r=min\{2n+1-x, x-(2n-1)\}$, 

then $B(x,r) \subset S^c$

so $S^c$ is an open set which concludes  $S$ is a closed sets


---



(7) The set $\{\dfrac{1}{n} \mid n \in \mathbb{N}\} \subset \mathbb{R}$ is closed.

错

we will check the complement $S^c$.

realize that $\lim\limits_{n \rightarrow \infty} \dfrac{1}{n}=0$

$0 \in S^c  \quad \dfrac{1}{n} \notin S^c \quad \text{but} \quad \lim\limits_{n \rightarrow \infty} \dfrac{1}{n}=0 \in S^c$

if we take a ball around 0, 

$B(0, \epsilon)=(-\epsilon,\epsilon)$

it doesn't matter how small $\epsilon$ is, we can find a $\dfrac{1}{n}$ in this ball, but $\dfrac{1}{n} \notin S^c$. 

so $B(0, \epsilon) \nsubseteq S^c$

so $S^c$ is not open 

thus the set $\{\dfrac{1}{n} \mid n \in \mathbb{N}\} \subset \mathbb{R}$ is not closed.


---



(8) The set $\mathbb{Q} \subset \mathbb{R}$ is closed.

错

we will check its complement i.e. irrational numbers $\mathbb{R} \setminus \mathbb{Q}$

for all $x \in \mathbb{R} \setminus \mathbb{Q}$

$B(x,\epsilon)=(x-\epsilon,x+\epsilon)$

since every irrational number is a limit of sequence of rational numbers, this ball will contain rational number. 

$B(x,\epsilon) \nsubseteq  \mathbb{R} \setminus \mathbb{Q}$

so the set of irrational numbers is not open. thus $\mathbb{Q}$ is not closed.


---



(9) The set of irrational numbers $\mathbb{R} \setminus \mathbb{Q}$ is closed.

false

we will check its complement i.e. $\mathbb{Q}$

$0 \in \mathbb{Q} \quad B(0,\epsilon)=(-\epsilon,\epsilon)$

this ball contains irrational point $\dfrac{\sqrt{2}}{n}$ for large $n$. 

this means  $\mathbb{Q}$ is not open, thus $\mathbb{R} \setminus \mathbb{Q}$ is not closed.


---



(10) The set:
$$
\bigcup_{n=1}^{\infty} \left[ \frac{1}{n}, 1 - \frac{1}{n} \right]
$$
is closed.

错

because $\bigcup_{n=1}^{\infty} \left[ \frac{1}{n}, 1 - \frac{1}{n} \right]=(0,1)$ which is open.

first, let us show $\bigcup_{n=1}^{\infty} \left[ \frac{1}{n}, 1 - \frac{1}{n} \right] \subset (0,1)$
$x \in \bigcup_{n=1}^{\infty} \left[ \frac{1}{n}, 1 - \frac{1}{n} \right]$

this means 

$x \in \left[ \frac{1}{n}, 1 - \frac{1}{n} \right]$

for some $n \geq 1$

$\frac{1}{n}>0, \quad \text{so} \quad 0<\frac{1}{n} \leq x \leq 1-\frac{1}{n}<1$

so $0<x<1$, so $x \in (0,1)$

now let us show that $(0,1) \subset \bigcup_{n=1}^{\infty} \left[ \frac{1}{n}, 1 - \frac{1}{n} \right]$



we have  $\lim\limits_{n \rightarrow \infty} 1-\dfrac{1}{n}=1 $



let $\epsilon=1-x$, then there exist $N_1$, st $n\geq N_1$

$\dfrac{1}{n}=|\dfrac{1}{n}|=|1-\dfrac{1}{n}-1|<\epsilon=1-x$

this says $\dfrac{1}{n}<1-x$

which is $x<1-\dfrac{1}{n}$ for $n \geq N_1$



we have  $\lim\limits_{n \rightarrow \infty} \dfrac{1}{n}=0 $

let  $\epsilon =|x|$ 

there is a $N_2 \in \mathbb{N}$, st. if $n \geq N_2$
$$
\dfrac{1}{n}=|\dfrac{1}{n}|<\epsilon=|x|=x \\
x>\dfrac{1}{n} \quad \text{for} \quad n>N_2
$$


if we pick $N=max\{N_1,N_2\}$

$$
1-\dfrac{1}{n}>x>\dfrac{1}{n}
$$

so $x \in (\frac{1}{n}, 1 - \frac{1}{n})  \subset \left[ \frac{1}{n}, 1 - \frac{1}{n} \right]$ for some $n$.

so $x \in \bigcup_{n=1}^{\infty} \left[ \frac{1}{n}, 1 - \frac{1}{n} \right]$

so we showed $(0,1) \subset \left[ \frac{1}{n}, 1 - \frac{1}{n} \right]$

which concludes that two sets are equal.


---



(11) The set:
$$
\bigcap_{n=1}^{\infty} \left( -\frac{1}{n}, 1 + \frac{1}{n} \right)
$$
is closed.

$\bigcap_{n=1}^{\infty} \left( -\frac{1}{n}, 1 + \frac{1}{n} \right)=[0,1]$ 

$[0,1]$ 是闭集


---



(12) The set $[1, 2] \times [0, 1] \subset \mathbb{R}^2$ is closed.

对

assume $P=(x,y)$ inside the region $[1, 2] \times [0, 1]$

$r=min\{x-1, 2-x, 1-y, y\}$

$B(P,r) \subset [1, 2] \times [0, 1]$


---



(13) The set $[1, 2] \times (0, 1) \subset \mathbb{R}^2$ is closed.

错

$S^C$ is not open 

since $P=(\dfrac{1}{2},0) \subset S^C$

then $B(P,\epsilon)$, it will contain point inside of the region.

so  $B(P,\epsilon) \nsubseteq S^c$

so $S^c$ is not open, $S$ is not closed 


---



(14) The set $\{2024\}$ is closed.

对

it's complement $(-\infty,2024)\cup (2024,\infty)$

is open since it is union of open sets.


---



(15) The set $\{(x, y) \in \mathbb{R}^2 \mid xy = 1\}$ is open.

错

for example, we take $(1,1) \in S$

if we take a ball centered at $P=(1,1)$ with radius $\epsilon$, $B(P,\epsilon)$

this ball includes $(1+\dfrac{\epsilon}{2},1)$ but it is not in the set S. 


---



(16) The set $\{(x, y) \in \mathbb{R}^2 \mid xy = 1\}$ is closed.

对

the complement is given by $g^{-1}((-\infty,1) \cup (1,\infty))$, where $g(x,y)=xy$

since g is continuous $(-\infty,1) \cup (1,\infty)$ is open

so its preimage is also open, so this complement is open.


---



(17) The set $\{(x, y) \in \mathbb{R}^2 \mid x^2 + xy + y^2 = 2023\}$ is closed.

对

$S=g^{-1}({2023})$ where $g(x,y) =x^2 + xy + y^2$

since $g$ is continuous $\{2023\}$ is closed

so its preimage is also closed, so $S$ is closed


---



(18) The set $\{(x, y) \in \mathbb{R}^2 \mid y = \frac{1}{x}\}$ is closed.

对

since no point with x=0 can be in S, this set is same as g^{-1}({1}) where g(x,y)=xy

since $g$ is continuous $\{1\}$ is closed

so its preimage is also closed, so $S$ is closed


---



(19) The set
$$
\bigcup_{n=1}^{\infty} \{n\} \times [0, 1]
$$
is closed.

对

检查它的补集 $S^c$

如果 $P=(x_P,y_P),x_P < 1$

那么 $B(P,1-x_P) \in S^c$

如果 $P=(x_P,y_P) \in (n,n+1)$

那么，设 $\epsilon = min\{x-n, n+1-x\}$

$B(P, \epsilon) \subset S^c$

如果 $P=(x_P,y_P),y_P < 1$

那么 $B(P, |y_P|) \in S^c$

如果 $P=(x_P,y_P),y_P > 1$

那么 $B(P,y_P-1) \in S^c$

所以 $S^c$ 是开集，所以 $S$ 是闭集。


---



(20) The set
$$
\bigcup_{n=1}^{\infty} \left\{ \frac{1}{n} \right\} \times [0, 1]
$$
is closed.

错

设$P=(x,y)$,

$x=0,y \in [0,1]$

如果我们在P附近构造一个开球，这个球会包括某个点A，  $A=(x_0,y_0)$，其中，

$x_0=\dfrac{1}{n},y_0 \in [0,1]$

因为当 $n \rightarrow \infty$ 时，$\dfrac{1}{n} \rightarrow 0$ 

所以这个开球会包含 $S^c$ 之外的点，所以 $S^c$ 不是开集，故 $S$ 不是闭集。


---



# PS9：



## Question 1:

Determine whether each of the following is True or False.



### (a)

The set $ S_1 = \{ (x,y,z) \in \mathbb{R}^3 : x^2 + 2y^2 + 3z^2 \leq 12 \} $ is closed and bounded.

### Solution:

True

$g(x,y,z)=x^2 + 2y^2 + 3z^2$ is a polynomial, so it is continuous.

$S_1=g^{-1}((-\infty,12])$ and since $(-\infty,12]$ is a closed set, $S_1$ is closed as well.

Also, $x^2, 2y^2, 3z^2 \leq 12$, it is bounded.

---



### (b) 

The set $ S_2 = \{ (x,y,z) \in \mathbb{R}^3 : 2x + y - z \leq 10 \} $ is closed and bounded.

### Solution:

False

it is an infinite plain, it is not bounded

family of points, $P_t(0,t,t) \in S_2$, for all $t \in \mathbb{R}$

as $t \rightarrow \infty$, this family goes to infinity as well

---



### (c) 

The set $ S_3 = \{ (x,y,z) \in \mathbb{R}^3 : x^2 + y^2 + z^2 < 25 \} $ is closed and bounded.

### Solution:

False

$S_3$ is a sphere with radius 5, but the boundaries doesn't included, so it is bounded but not closed.

---



### (d) 

The set $ S_4 = \{ (x,y,z) \in \mathbb{R}^3 : x^2 + y^2 + z^2 \leq 16,  \text{ and } 4x + 3y - 5z  \leq 20 \} $ is closed and bounded.

### Solution:

false

it is not bounded

family of points, $P_t(0,5t,3t) \in S_4$, for all $t \in \mathbf{R}$

as $t \rightarrow \infty$, this family goes to infinity, so it is bounded but not bounded.

---



### (e) 

The set  $S_5 = \{ (x,y,z) \in \mathbb{R}^3 : x^3 + y^2 + z \leq 10 \}$ is closed and bounded.

### Solution:

false

it is closed but not bounded.

the function $e(x,y,z)=x^3+y^2+z$ is a polynomial, so it is continuous

$S_5=e^{-1}((-\infty,10]) and (-\infty,10]$ is closed, then $S_5$ is closed as well.

family of points, $P_t(0,0,t) \in S_5$, for all $t \leq 10$ in the set $S_5$ and as $t \rightarrow -\infty$, this point goes to infinity, so $S_5$ is not bounded.

---



### (f)

The set  $S_6 = \{ (x,y,z) \in \mathbb{R}^3 : x^2 + y^2 + z^{-2} \leq 10  \}$ is closed and bounded.

### Solution:

false

it is cloed but not bounded

$f(x,y,z)=x^2 + y^2 + \dfrac{1}{z^2}$, this function is not continuous when $z=0$

$z^2 \geq \dfrac{1}{10-(x^2+y^2)}>\dfrac{1}{10}$, we can see that z cannot be $z=0$

if we multiply by $z^2$, we are not adding any points so $f(x,y,z)=x^2z^2+y^2z^2+1-10z^2 \leq 0$
this function is continuous, $S_6$ is $f^{-1}((-\infty,0])  with (-\infty,0]$ is closed, so $S_6$ is closed as well.

boundedness or not?
when $x=0,y=0, z^{-2} \leq 10, z^{2} \geq 10$, then z can be as bigger as we want, $S_6$ is not bounded.

---



## Question 2:



### (I)

Let $ S_1 = \{ (x,y) \in \mathbb{R}^2 : x^2 + y^2 \geq 1 \} $. Is $ S_1 $ closed and/or bounded? Give an example of a continuous function $ f : S_1 \to \mathbb{R} $ which does not achieve a maximum nor a minimum on the set $ S_1 $.

### Solution:

let $g(x,y)=x^2 + y^2$, this is continuous since $g$ is a polynomial

$S_1=g^{-1}([1,+\infty)$, since $[1,+\infty)$ is closed, $S_1$ is also closed.

boundedness:

if $x=0, y^2 \geq 1$, so we can choose y as bigger as we want, so $S_1$ is not bounded.

also, any point $x,y \rightarrow \infty$ is in $S_1$

$f(x,y)=x$ or $f(x,y)=y$. they don't have max or min. As $x,y \rightarrow \infty \in S_1$, $f(x,y) \rightarrow \infty $

and as $x,y \rightarrow -\infty \in S_1$, $f(x,y) \rightarrow -\infty $

---



### (II) 

Let $ S_2 = \{ (x,y,z) \in \mathbb{R}^3 : x^2 + y^2 + z^2 < 1 \} $. Is $ S_2 $ closed and/or bounded? Give an example of a continuous function $ f : S_2 \to \mathbb{R} $ which does not achieve a maximum nor a minimum on the set $ S_2 $.

### Solution:

$S_2={(x,y,z) \in \mathbb{R^3}, x^2 + y^2 + z^2 <1}$
set $g(x,y,z) = x^2 + y^2 + z^2$ which is a polynomial, so continuous

then $S_2=g^{-1}([0,1)$, since $[0,1)$ is open,$ S_2$ is also open.

$x^2 , y^2 , z^2 <1$, so it is bounded.

$f(x,y,z)=\dfrac{1}{1-x}$ does not have max.

as $x \rightarrow 1$, $\dfrac{1}{1-x} \rightarrow \infty$ 

and $f(x,y,z)=\dfrac{1}{1-x}$ does not have max.


---



### (III) 

Let $ S_3 = \{ (x,y) \in \mathbb{R}^2 : x^2 + y^2 + 2x \leq 0 \} $. Is $ S_3 $ closed and/or bounded? Give an example of a non-constant function $ h : S_3 \to \mathbb{R} $ which does not achieve a maximum on the set $ S_3 $.

### Solution:

$h(x,y)=x^2 + y^2+ 2x$ it is a polynomial so it is continuous.

$S_3=h^{-1}((- \infty,0]$, since $(- \infty,0]$ is closed, $S_3$ is also closed.

it is bounded.

$x^2 + y^2+ 2x = x^2 + 2x + 1 + y^2 - 1 = (x + 1)^2 + y^2 - 1$

$(x + 1)^2 + y^2 \leq 1$ . it is a sphere with radius 1

$f(x,y)=\dfrac{1}{1+x}$ is not continous so that doesn't have max as $x \rightarrow -1$ makes the function goes infinity.

---



## Question 3

Consider the function 

$$
f : \mathbb{R}^2 \to \mathbb{R}, \quad f(x, y) = xy^2
$$

subject to the constraint 

$$
g(x, y) = x^2 + 2y^2 < 3.
$$



### (I) 

Sketch the feasible set and explain why $ f $ achieves extrema (maximum and minimum) subject to the above constraint.

### Solution:

this constraint represents ellipse with radius $\sqrt{3}$ and $\sqrt{\dfrac{3}{2}}$, center is $(0,0)$.

it is closed (contains boundary)

---



### (II) 

Find the maximum and minimum of $ f $ subject to the above constraint.

### Solution:

max at $(1,\pm 1)$ with value 1
min at $(-1,\pm 1)$ with value -1

---



# PS10:



## Question 1:

Let $ f: \mathbb{R}^2 \to \mathbb{R} $ be defined by $ f(x, y) = -20x - 10y^2 $ and the constraints 

$$
x^2 + y^2 \leq 10. \quad \text{and} \quad x geq 0
$$



### (i)

Sketch the feasible set and show that it is closed and bounded. Conclude that $f $ achieves both its maximum and minimum.

### Solution:

the feasible set is this semi-disk, with radius 10. since $f$ is a polynomial, it is continuous. Domain is closed and bounded, so it contains both max and min by extreme value theorem.

---



### (ii)

Using the Kuhn-Tucker method, find the extrema of $f$ subject to the above constraints.

### Solution:

$$
f(x,y)=-20x-10y^2 \\
\alpha (x,y)=x^2 + y^2 \\
\beta (x,y)=x
$$

$$
\nabla f=\lambda_{\alpha} \nabla_{\alpha} + \lambda_{\beta} \nabla_{\beta}
$$

**case1:**

all constraints are inactive, then $\lambda_{\alpha}, \lambda_{\beta} = 0$

then 
$$
\nabla f=0 
\Rightarrow 
\begin{cases}
f_x=0 \\
f_y=0
\end{cases}
\Rightarrow 
\begin{cases}
-20=0 \quad \text{(impossible)} \\
-20y=0
\end{cases}
$$
so there is no candidate from this case.

**case2:**

$\alpha$ : inactive
$\beta$ : active

$$
\nabla f=\lambda_{\alpha} \nabla_{\alpha} \\
\beta(x,y)=0
$$

$$
\begin{cases}
f_x=\lambda_{\beta} \beta_{x} \\
f_x=\lambda_{\beta} \beta_{y} \\
x=0
\end{cases}
$$

$$
\begin{cases}
-20=\lambda_{\beta} 1 \\
-20y=\lambda_{\beta} 0 \\
x=0
\end{cases}
$$

$(x,y)=(0,0)$
this is a candidate, it satisfies both constraints.

**case3:**
$\alpha$ : active
$\beta$ : inactive
$$
\nabla f=\lambda_{\alpha} \nabla_{\alpha} \\
\alpha(x,y)=0
$$

$$
\begin{cases}
-20=\lambda_{\alpha} 2x \\
-20y=\lambda_{\alpha} 2y \\
x^2 + y^2=100
\end{cases}
$$



if $y=0$, 

then $x=10$ or $x=-10$
since $x=-10$ doesn't satisfy the constraint $x \geq 0$, $(-10,0)$ is not a candidate

let's check $(0,10)$, it satisfies both constraints $x^2 + y^2 \leq 100, \quad  x \geq 0$
so it is our candidate for extrema

if $y \neq 0$, 
$$
-20y=\lambda_{\alpha} 2y \Rightarrow \lambda_{\alpha}=-10 \Rightarrow 
\begin{cases}
x=1 \\
y=\pm 3\sqrt{11}
\end{cases}
$$
the point $(1,\pm 3\sqrt{11})$ satisfies both constraints $x^2 + y^2 \leq 100, \quad x \geq 0$

so these are other candidates for extrema.

**case4:**
all constraints are active
$$
\nabla f=\lambda_{\alpha} \nabla_{\alpha} \\
\alpha =100 \\
\beta =0
$$

$$
\begin{cases}
-20=\lambda_{\alpha} 2x + \lambda_{\beta} \\
-20y=\lambda_{\alpha} 2y \\
x^2 + y^2=100
\end{cases}
$$

$$
\begin{cases}
x=0 \\
y=\pm 10
\end{cases}
$$

$(0,\pm 10)$ are candidates.

after calculating $f(x,y)$ at the points that are candidates, 

$f$ has its max at $(0,0)$ with value 0, 

$f$ has its min at $(1,\pm 3\sqrt{11})$ with value -1010.

---



## Question 2:

Let $ f: \mathbb{R}^2 \to \mathbb{R} $ be defined by $ f(x, y)=2x + y^2 - 3 $ and the constraints 

$$
x^2 + y^2\leq 10 \quad \text{and} \quad x \geq 0.
$$



### (1)

Sketch the feasible set in the plane and explain why $f $ attains extrema (maximum and minimum) subject to the above constraints.

### Solution:

feasible set is a semi-disk with radius $\sqrt{10}$
since feasible set is closed and bounded on $f$, and $f(x,y)$ is continous because it is a polynomial, $f$ has both max and min in these constrains.





### (2)

Use the Kuhn-Tucker method to find the maximum and the minimum of $f$ subject to the above constraints.

### Solution:

$$
f(x,y)=2x+y^2-3 \\
\alpha (x,y)=x^2+y^2 \\
\beta (x,y)=x
$$

$$
\nabla f=\lambda_{\alpha} \nabla_{\alpha} + \lambda_{\beta} \nabla_{\beta}
$$

**case1:**
all constraints are inactive
$$
\nabla f =0 \\
\Downarrow \\
\begin{cases}
f_x=0 \\
f_y=0
\end{cases}\\
\Downarrow \\
\begin{cases}
2=0 \\
2y=0
\end{cases}
$$
this is not possible, so no candidates in this case.

**case2:**
$\alpha$ : inactive
$\beta$ : active
$$
\nabla f=\lambda_{\beta} \nabla_{\beta} \\
\beta = 0
$$

$$
2=\lambda_{\beta} 1 \\
2y=\lambda_{\beta} 0 \\
x=0
$$

$(x,y)=(0,0)$ this point satisfies constraint  $\alpha(x,y)$ as well.

**case3:**
$\alpha$ : active
$\beta$ : inactive
$$
\nabla f=\lambda_{\alpha} \nabla_{\alpha} \\
\alpha = 10
$$

$$
2=\lambda_{\alpha} 2x \\
2y=\lambda_{\alpha} 2y \\
x^2 + y^2 = 10
$$



if $y =0$
$x= \pm \sqrt{10}$ 

$(0,\sqrt{10})$ it is a candidate
and
$(0,-\sqrt{10})$ it is not possible since it doesn't satisfies $x \geq 0$

if $y \neq 0$
then $2y= \lambda_{\alpha} 2y$

$\lambda_{\alpha}=0$

then 
$$
\begin{cases}
x=1 \\
y=\pm 3 
\end{cases}
$$
then $(1,\pm3)$ are candidates for extrema since they satisfies the both of the constrains

**case4:**
all constraints are active
$$
\nabla f=\lambda_{\alpha} \nabla_{\alpha} + \lambda_{\beta} \nabla_{\beta} \\
\alpha=10 \\
\beta=0
$$

$$
2=2x\lambda_{\alpha} + \lambda_{\beta} \\
2y=2y\lambda_{\alpha} + 2y \lambda_{\beta} =2y(\lambda_{\alpha}+\lambda_{\beta}) \\
x^2 + y^2 = 10 \\
x=0
$$

so $y=\pm \sqrt{10}$

if we calculate $f(x,y)$ at these candidates, we will have the following:
f has max at $(1,\pm3)$ of 8
min at $(0,0)$ of -3.

---



## Question 3:

Let $ f : \mathbb{R}^2 \to \mathbb{R} $ be defined by $ f(x, y) = 2 + x + y^2 $, and the constraints

$$
x^2 - 2x + y^2 \geq 0, \quad x^2 - 4x + y^2 \leq 0, \quad x + y \leq 3
$$





### (a)

Sketch the feasible set in the plane and explain why $ f $ attains extrema (maximum and minimum) subject to the above constraints. 

---



### (b) 

Use the Kuhn-Tucker method to find the maximum and the minimum of \( f \) subject to the above constraints.

### Solution:

first constraint becomes: 
$$
x^2 - 2x + 1 + y^2 \geq 1 \Rightarrow (x-1)^2 + y^2 \geq 1
$$
second constraint becomes: 
$$
x^2 - 4x + 4+ y^2 \leq 4 \Rightarrow (x-2)^2 + y^2 \leq 4
$$

$$
f(x,y)=2+x+y^2 \\
\alpha (x,y)=x^2 - 2x + y^2 \\
\beta (x,y)=x^2 -4x + y^2 \\
\gamma (x,y)=x+y
$$

**case1:**
all constraints are inactive
$$
\nabla f=0  \\
\Downarrow \\
\begin{cases}
f_x=0 \\
f_y=0
\end{cases}
$$

$$
\begin{cases}
1=0 \quad \text{impossible} \\
2y=0
\end{cases}
$$

so no candidate

**case2:**
$\alpha$ : inactive
$\beta$ : inactive
$\gamma$ : active
$$
\nabla f = \lambda_{\gamma} \dot \nabla_{\gamma} \\
\gamma=3
$$

$$
\begin{cases}
1=\lambda_{\gamma} 1 \\
2y=\lambda_{\gamma} 1 \\
x+y=3
\end{cases}
$$

$$
\begin{cases}
\lambda_{\gamma}=1 \\
y=\dfrac{1}{2} \\
x=\dfrac{5}{2}
\end{cases}
$$

from the picture of feasible set, it can be seen that it satisfies the constraint.

**case3:**
$\alpha$ :  active
$\beta$ :  inactive
$\gamma$ :  inactive
$$
\nabla f = \lambda_{\alpha} \dot \nabla_{\alpha} \\
\alpha =0
$$

$$
\begin{cases}
1= \lambda_{\alpha} (2x-2) \\
2y=\lambda_{\alpha} 2y \\
x^2 - 2x + y^2=0
\end{cases}
$$

if $y=0$
$x=0$ or 2
$(0,0)$ does not satisfy, since $\beta(0,0)$ is not $<0$, but we said $\beta$ is inactive means it is not a candidate.

or 

$x=2$

$(2,0)$ satisfies each constraints, so it is a candidate.

if $y \neq 0$
then 
$$
\begin{cases}
\lambda_{\alpha} = 1 \\ 
x=\dfrac{3}{2} \\
y= \pm \dfrac{\sqrt{3}}{2} 
\end{cases}
$$
so $(\dfrac{3}{2},\pm \dfrac{\sqrt{3}}{2})$ are candidates.

**case4:**
$\alpha$ : inactive
$\beta$ : active
$\gamma$ : inactive
$$
\nabla f = \lambda_{\beta} \dot \nabla_{\beta} \\
\beta =0
$$

$$
1= \lambda_{\beta} (2x-4) \\
2y=\lambda_{\beta} 2y \\
x^2 - 4x + y^2=0
$$

if $y=0$
$x=0 \ \text{or} \ 4$ by third equation,
$\alpha (0,0)=0$, but we said $\alpha$ is inactive, which means $\alpha(x,y)>0$
so $(0,0)$ is not a candidate.

$(4,0)$ satisfies each constraints, $\alpha(4,0)>0$ , $\beta (4,0)=0$ , $\gamma (4,0)<3$
so it is a candidate.

if $y \neq 0$
then $\lambda_{\beta} = 1, \ x=\dfrac{5}{2}$, by first equation, 

$y= \pm \dfrac{\sqrt{15}}{2}$, by the first equation. 

but $\gamma(\dfrac{5}{2}, \dfrac{\sqrt{15}}{2}) >3$, which is not possible, so it is not a candidate.

$(\dfrac{5}{2}, -\dfrac{\sqrt{15}}{2})$ is a candidate.

**case5:**
$\alpha$ : active
$\beta$ : active
$\gamma$ : inactive
$$
\alpha =0 \\
\beta =0 \\
\gamma <3
$$
this only contains $(0,0)$

**case6:**
$\alpha$ : inactive
$\beta$ : active
$\gamma$ : active
$$
\alpha >0 \\
\beta =0 \\
\gamma =3
$$
$(x_{1,2},3-x_{1,2}) x_{1,2}=\dfrac{5}{2} \pm \dfrac{\sqrt{14}}{2}$

**case7:**
$$
\alpha =0 \\
\beta <0 \\
\gamma =3
$$
there is no candidate.

case8:
$$
\alpha =0 \\
\beta =0 \\
\gamma =3
$$
there is no candidate.

after calculating all candidates,max is 825 at $(\dfrac{5}{2}, -\dfrac{\sqrt{15}}{2})$
min is 2 at $(0,0)$

---




# PS11:



## Question 1:

Decide if the following sets are convex or not, and justify your answers:



### (1)

$ A = \{ (x, y) \ | \ x + y \leq 10, x \geq 0, y \geq 0 \} $

### Solution:

设

$P(x_P,y_P) , Q(x_Q,y_Q) \in A$

则有

$x_P + y_P \leq 10, x_P \geq 0, y_P \geq 0$

$x_Q + y_Q \leq 10, x_Q \geq 0, y_Q \geq 0$

$\lambda P + (1-\lambda)Q = (\lambda x_P + (1-\lambda) x_Q) + (\lambda y_P + (1-\lambda) y_Q)$

易得

$\lambda x_P + (1-\lambda) x_Q \geq 0$

$\lambda y_P + (1-\lambda) y_Q \geq 0$

因为

 $\lambda, (1-\lambda), x_P, y_P, x_Q, y_Q >0$

所以

$(\lambda x_P + (1-\lambda) x_Q) + (\lambda y_P + (1-\lambda) y_Q) = \lambda (x_P + y_P) + (1-\lambda)(x_Q + y_Q) < \lambda 10 + (1- \lambda) 10 =10$

所以

 $\lambda P + (1-\lambda)Q \in A ， \lambda \in [0,1]$

所以

 A 为 convex.

---



### (2) 

$ B = \{ (x, y) \ | \ x^2 + y^2 \leq 4 \} $

### Solution:

设

$P(x_P,y_P), Q(x_Q,y_Q) \in A$

则有

$|P|=\sqrt{x_P^2 + y_P^2}$

$|P + Q| \leq |P| + |Q|$

$| \lambda P | =    | \lambda | | P |$

可得

$|\lambda P + (1-\lambda) Q| \leq |\lambda P| + |(1-\lambda) Q| = \lambda | P | + (1- \lambda) |Q| = 2$

所以

$\lambda P + (1-\lambda)Q \in B$

故 B 为convex.

---



### (3)
$ C = \mathbb{Z} \subset \mathbb{R} $

### Solution:

not convex

$0 \in C$

$1 \in C$

$\lambda 0 + (1-\lambda) 1 = (1-\lambda) 1 $

and it is not always in $C$

when $\lambda = \dfrac{1}{3}$





### (4) 
$ D = \{ \sin(\dfrac{1}{x}) \ | \ x \in (0, +\infty) \} \subset \mathbb{R} $

### Solution:

convex

for $x_1=\dfrac{\pi}{2}, x_2=\dfrac{2}{3 \pi}, sin(\dfrac{1}{x_1})=sin(\dfrac{\pi}{2})=1$

sin$(\dfrac{1}{x_2})=-1$

$-1, 1 \in D = (sin(\dfrac{1}{x}))$

the function is continuous, so the intermediate value theorem tells us $D=[-1,1]$ is a segment, and this function is convex.

---



### (5) 

$ E = \{ (x, y) \subset \mathbb{R}^2 \ | \ y^2 \leq x \} $

### Solution:

$P, Q \in E$

$$
[\lambda y_P + (1 - \lambda) y_Q]^2 - [\lambda x_P + (1 - \lambda) x_Q] \leq 0
\\
\Downarrow
\\
[\lambda y_P + (1 - \lambda) y_Q]^2 \leq [\lambda x_P + (1 - \lambda) x_Q]
\\
\Downarrow
\\
\lambda P + (1-\lambda)Q \in E
$$



---



# PS12:



## Question 1：

Determine whether each of the following is true or false. Justify your answers.



### (1)

If $S_1$ and $S_2$ are two convex sets in $ \mathbb{R}^2 $, then their union  

$$
S_1 \cup S_2 = \{ x \in \mathbb{R}^2 : x \in S_1 \text{ or } x \in S_2\}
$$

must be a convex set in $ \mathbb{R}^2 $.

### Solution:

FALSE. e.g. $ \{(0,0)\} \cup \{(1,0)\} $

**First example:**
assume two convex sets

$S_1={(0,0)}, \ S_2={(1,0)}$ 

assume

$P=(0,0) \in S_1 \cup S_2$
$Q=(1,0) \in S_1 \cup S_2$

when  $\lambda=\dfrac{1}{2}$

$\lambda P+(1-\lambda)Q=(\dfrac{1}{2},0) \notin S_1 \cup S_2 $

so $S_1 \cup S_2$ is not convex.

**Second example**

$S_1=\{(x,y)|x^2 + y^2 \leq 1\}$

$S_2=\{(x,y)|(x-4)^2 + y^2 \leq 1\}$

$(0,0) \in S_1 \cup S_2$
$(4,0) \in S_1 \cup S_2$

$\lambda (0,0)+(1-\lambda)(4,0)=(2,0) \notin S_1 \cup S_2 $

when $\lambda=\dfrac{1}{2}$

so it is not convex

**Third example:**

$S_1=\{(x,0)|x \in [0, 1]\}$

$S_2=\{(0,y)|y \in [0, 1]\}$

both of them are segments, so convex set

however 

$P=(1,0) \in S_1 \cup S_2$
$Q=(0,1) \in S_1 \cup S_2$

$\lambda P+(1-\lambda)Q=(\lambda,1-\lambda)$

and this not inside of $S_1 \cup S_2$ for $\lambda \neq 0,1 \ \text{and} \ \lambda \in (0,1)$

so $S_1 \cup S_2$ is not convex.

---



### (2)

If $ f $ and $ g $ are two concave functions on $ \mathbb{R}^n $, then the function $ f + g $ is concave on $ \mathbb{R}^n $.

### Solution:

TRUE. Hint: use definition...

since $f$ and $g$ are concave, by definition 

$f(\lambda P+(1-\lambda)Q) \geq \lambda f(P)+(1-\lambda) f(Q)$

$g(\lambda P+(1-\lambda)Q) \geq \lambda g(P)+(1-\lambda) g(Q)$

for all $P,Q \in \mathbb{R^n}$

$$
\begin{align}
(f+g)(\lambda P+(1-\lambda)Q) &=f(\lambda P+(1-\lambda)Q) + g(\lambda P+(1-\lambda)Q) \\
\\
&\geq \lambda f(P) + (1-\lambda) f(Q) + \lambda g(P) + (1-\lambda) g(Q) \\
\\
&=\lambda [f(P) + f(Q)] + (1-\lambda)[f(P) + f(Q)] \\
\\
&=\lambda (f+g)(P) + (1-\lambda)(f+g)(Q) \\
\end{align}
$$
then
$$
(f+g)(\lambda P+(1-\lambda)Q) \geq \lambda (f+g)(P) + (1-\lambda)(f+g)(Q)
$$
This means $f+g$ is a concave function on $\mathbb{R^n}$

---



## Question2

Sketch the following sets and decide which are convex. Justify your answers.



### (a) 

$ \{(x,y) \in \mathbb{R}^2 \mid x, y \geq 0 \text{ and } x + y < 1 \} $ 

### Solution:

convex 

assume

$P=(x_P,y_P), Q=(x_Q,y_Q) \in S_1$

we have

$x_P,y_P, x_Q,y_Q \geq 0$ 

$x_P + y_P <1$ 

$x_Q + y_Q <1$

and


$\lambda x_P + (1-\lambda) x_Q  \geq 0, \quad \text{since} \quad \lambda, 1-\lambda, x_P, x_Q \geq 0 $

$\lambda y_P + (1-\lambda) y_Q \geq 0, \quad \text{since} \quad \lambda, 1-\lambda, y_P, y_Q \geq 0 $

so

$\lambda x_P + (1-\lambda) x_Q + \lambda y_P + (1-\lambda) y_Q = \lambda (x_P + y_P) + (1-\lambda) (x_Q  +  y_Q) < \lambda 1 + (1-\lambda) 1 = 1 \quad \text{since} \quad P,Q \in S_1$

so we showed

$\lambda P + (1-\lambda)Q \in S_1$

So $S_1$ is convex.

---



### (b) 

$ \{(x,y) \in \mathbb{R}^2 \mid 1 \leq x^2 + y^2 \leq 4 \} $ 

### Solution:

not convex 

for instance $(1,0) (-1,0) \in S_2$

however, if $\lambda =\dfrac{1}{2}$

$\dfrac{1}{2} (1,0) + (1-\dfrac{1}{2})(-1,0) = (0,0) \notin S_2$





### (c) 
$ \{x \in \mathbb{R} \mid |x| > 1 \} $

### Solution:

not convex 

$P=2, Q=-2 \in S_3$

if $\lambda =\dfrac{1}{2}$

$\dfrac{1}{2} 2 + (1-\dfrac{1}{2}) (-2) = 0 \notin S_3$

---



## Question3

Consider the function  
$$
C(x, y) = \dfrac{1}{100}x^2 - 10x + \dfrac{1}{300}y^3 - 9y \quad \text{for } x, y \geq 0.
$$



### (a) 

Examine if $C$ is concave, convex or neither of them. 

### Solution:

Convex on S.  

note that the domain is convex, it is the first quadrant

we will use second derivative test

$$
\begin{cases}C_x(x,y)=\dfrac{1}{50} x - 10 \\
C_y(x,y)=\dfrac{1}{100} y - 9 
\end{cases} 
\rightarrow
\begin{cases}
C_{xx}=\dfrac{1}{50} \\
C_{xy}=0 \\
C_{yx}=0 \\
C_{yy}=\dfrac{1}{50}y
\end{cases}
$$

$$
H_c(x,y)=\begin{pmatrix}
\dfrac{1}{50} & 0  \\
0 & \dfrac{1}{50}y  
\end{pmatrix}
$$



since 
$$
\dfrac{1}{50} \geq 0 \\
\dfrac{1}{50}y \geq 0 \\
\\
det H_c(x,y) \geq 0 
$$
then by the theorem 2 p9 chap7, the function is convex 

by the same theorem, it is not concave since $C_{xx}, C_{yy}$ are not non-positive.

---



### (b) 

Find the critical points of $ C$ and show that at these points $ C $ attains a minimum.

### Solution:


$C_x=0$
$C_y=0$

$\dfrac{1}{50} x - 10 = 0$

$\dfrac{1}{100} y^2 - 9 = 0$

$x=500$
$y=\pm30$

but $y=-30$ is not in the domain

since the function is convex, this point $(500, 30)$ is the only minimum of the function $C$ by theorem 1, chap7

---



# PS13



## Question1

For which $ a \in \mathbb{R} $ is the function $ f: \mathbb{R}^3 \to \mathbb{R}, \ f(x, y, z) = x^2 + xz + ayz + z^2 $ convex? 

### Solution:

Taking second derivatives and computing minors, one finds the conditions $-a^2 \geq 0$ and $-2a^2 \geq 0$, which implies that $a =0$

$$
\begin{cases}
f_x=2x + z \\
f_y=az \\
f_z=x + ay +2z
\end{cases}
$$

$$
H_f = \begin{pmatrix}
f_{xx} & f_{xy} & f_{xz}  \\
f_{yx} & f_{yy} & f_{yz}  \\
f_{zx} & f_{zy} & f_{zz} 
\end{pmatrix}
=
\begin{pmatrix}
2 & 0 & 1  \\
0 & 0 & a  \\
1 & a & 2 
\end{pmatrix}
$$

First realize that one of the order one minor, $M_1(x,y,z)=2$

Then $f$ is not concave

one of the order two minor $M_2(x,y,z)=-a^2$

This can be non-negative only when $a=0$ 

If $a>0$ then it contradicts with convexity

Therefore $a=0$

In that case all other minors are either positive or 0

order one minors: 2,0,2

order two minors: 0,3,0

order three minors: $det (H_f)=0$

So when $a=0$, $f$ is convex.

All these are followed from theorem 6 and 7 in chap 7





## Question2

Show that the function $ f: \mathbb{R}^4 \to \mathbb{R}, \ f(x, y, z, w) = x^2 + y^2 + z^2 + w^2 - 2xw - 4yz $ is neither convex nor concave on $ \mathbb{R}^4 $.

### Solution:

Computing the minors of the Hessian matrix, the first order one minor is $ 2 > 0 $, so that $-1^1 2 < 0$, and the Hessian cannot be negative semidefinite, and $f$ cannot be concave. One of the other two minors is $-12 < 0$, which implies that the Hessian cannot be positive semidefinite, so that $ f $ cannot be convex.



$$
H_f = \begin{pmatrix}
2 & 0& 0 & -2 \\
0 & 2 & -4 & 0 \\
0 & -4 & 2 & 0 \\
-2 & 0 & 0 & 2
\end{pmatrix}
$$


$M_1=2$, so it is not concave by theorem 6

One of the order two minors 
$$
M_2 = \begin{pmatrix}
2 & -4 \\
-4 & 2
\end{pmatrix} \\
det(M_2)=-12<0
$$


This function cannot be positive by theorem 6/7.

example:

Let $g(x,y,z,w)=x + y + z + w $

$H_g=0$

All of the minors are 0

Thus $g$ is both convex and concave.

---



# PS14



## Question 1:

Compute the principal minors, the Hessian, and the bordered Hessian of the following functions:

(a) $f(x, y, z) = e^{x+y} + z$
(b) $g(x, y) = xy$
(c) $h(x, y) = e^{x}cos y$

---



### **Solution:**



#### (a) 

$$
H_f = \begin{pmatrix}
e^{x+y} & e^{x+y} & 0 \\
e^{x+y} & e^{x+y} & 0 \\
0 & 0 & 0
\end{pmatrix}
$$

$$
M_1^{(1)}=e^{x+y} \quad M_1^{(2)}=e^{x+y} \quad M_1^{(3)}=0 \\

M_2^{(1)}=0 \quad M_2^{(2)}=0 \quad M_2^{(3)}=0 \\

M_3=det (H_f) =0
$$

And also:

$$
BH_f = \begin{pmatrix}
0 & e^{x+y} & e^{x+y} & 1 \\
e^{x+y} & e^{x+y} & e^{x+y} & 0 \\
e^{x+y} & e^{x+y} & e^{x+y} & 0 \\
1 & 0 & 0 & 0
\end{pmatrix}
$$

---



#### (b) 

$$
H_g = \begin{pmatrix}
0 & 1 \\
1 & 0
\end{pmatrix}
$$

$$
M_1^{(1)} = 0 \quad M_1^{(2)} = 0 \\
M_2=det(H_g)=-1
$$

And also:

$$
BH_g = \begin{pmatrix}
0 & y & x \\
y & 0 & 1 \\
x & 1 & 0
\end{pmatrix}
$$

---



#### (c) 

$$
H_h = \begin{pmatrix}
e^x \cos y & -e^x \sin y \\
-e^x \sin y & -e^x \cos y
\end{pmatrix}
$$

$$
M_1^{(1)} = e^x \cos y \quad M_1^{(2)} = -e^x \cos y \\ 
M_2 = -e^{2x}
$$

And also:

$$
BH_h = \begin{pmatrix}
0 & e^x \cos y & -e^x \sin y \\
e^x \cos y & e^x \cos y & -e^x \sin y \\
-e^x \sin y & -e^x \sin y & -e^x \cos y
\end{pmatrix}
$$

---





## Question 2

Consider the function 

$$
f(x, y) = \frac{8y}{x}
$$

defined for $ x, y > 0 $.



### (a)

Sketch the level sets $ C_a $ and the upper level sets $ P_a $ of $ f $, for $ a = 1, 0, -1 $.

### Solution:

when $a=1$ 
$P_1=\{(x,y) : x>0, y>0, \dfrac{8y}{x} \geq 1 \}$

$C_1=\{(x,y) : x>0, y>0, \dfrac{8y}{x} =1 \}$

when $a=0$
$P_0=\{(x,y) : x>0, y>0, \dfrac{8y}{x} \geq 0 \}=\{(x,y) : x>0, y>0 \}$
$C_0=\{(x,y) : x>0, y>0, \dfrac{8y}{x} = 0 \}= \text{empty set}$

when $a=-1$, 
$P_{-1}=\{(x,y) : x>0, y>0, y \geq -\dfrac{x}{8} \}$

$C_{-1}=\{(x,y) : x>0, y>0, y = -\dfrac{x}{8} \}= \text{empty set}$





### (b)

Use the definition to examine if $ f $ is quasi-concave.

### Solution:

if $a>0$
$P_a=\{(x,y) : x>0, y>0, y \geq   \dfrac{ax}{8} \}$

if $a \leq 0$
$P_a=\{(x,y) : x>0, y>0, y \geq   \dfrac{ax}{8}\}=\{(x,y) : x>0, y>0\}$

in conclusion for all $a \in \mathbb{R}$, the upper level set $P_a$ is convex therefore $f$ is quasi-concave.

---



### (c)

Use the Second order derivative test to examine if $ f $ is concave and/or quasi-concave.

### Solution:

若函数 $f$ 是凹函数，那么 $f_{xx} \leq 0$, $f_{yy} \leq 0$ 且 $f_{xx} f_{yy} - f_{xy} f_{yx} \geq 0$。

而 $f_{xx}=\dfrac{16y}{x^3}>0$

所以 $f$ 不是凹函数。

是否为quasi-concave？

$$
BH_f = \begin{pmatrix}
0 & -\dfrac{8y}{x^2} & \dfrac{8}{x} \\
-\dfrac{8y}{x^2} & \dfrac{16y}{x^3} & -\dfrac{8}{x^2} \\
\dfrac{8}{x} & -\dfrac{8}{x^2} & 0
\end{pmatrix}
$$


$(-1)^2 D_2(\mathbf{x}) = 0$

无法判断是否为qusai-concave.

---

> 祝你天天开心！😊😊😊
>

